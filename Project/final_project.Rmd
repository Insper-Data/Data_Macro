---
title: "Preliminary impressions about the relationship between the level of public debt and the countries' ability to attract new foreign credits"
author: "Augusto Netto, Gabriella Garcia and Maria Clara Drzeviechi"
output:
  html_document:
    df_print: paged
    highlight: haddock
    number_section: yes
    theme: readable
    toc: yes
    toc_float:
      collapsed: yes
      smooth_scroll: yes
  pdf_document:
    toc: yes
---

<style>
body {
text-align: justify}
</style>


**Insper Data**



# Introduction and Motivation



# Literature Review

Discussions on how indebtedness can affect the macroeconomic variables of a country are widely addressed in the literature. This review will focus on three topics: debt and growth; debt overhang and debt tolerance.

The relationship between debt and growth was first found to be non-linear by Reinhart, Rogoff, and Savastano (2003). Later, Reinhart and Rogoff (2010) analyze countries distinguishing developed and emerging markets and they found out that, for both groups, a 90% debt to GDP ratio can be detrimental for growth. On the other hand, Kumar and Woo (2010) produced evidence that the negative impact of debt on growth is higher for developing countries when compared with developed countries. 
Thinking about debt tolerance, Reinhart, Rogoff and Savastano (2003) introduce the concept of debt intolerance and analyze how emerging markets find it difficult to face high levels of debt, while advanced countries face this issue more easily.  Later, Catão and Kapur (2006) discussed the macroeconomic determinants of a country’s volatility and how it impacts the spread rate it has to pay.

The concept of debt overhang refers to a debt burden so large that the country can not take any additional debt to finance itself. Krugman (1988) discussed the tradeoff for creditors when facing a debt overhang: financing or forgiving. Deshpande (1995) discusses how a situation of debt overhang can discourage investment. Reinhart, Reinhart, and Rogoff (2012) punctuated the main episodes in history about debt overhang.




# Dataset Description

The dataset used in this study is composed by the database provided by Arslanalp and Takahiro Tsuda, the World Economic Outlook from IMF and the WOrld Bank. The dataset is composed of 45 countries and covers sixteen years, from 2004 to 2019.  

```{r, echo=FALSE, message=FALSE} 
#adicionando libraries
library(tidyverse)
library(scales)
library(ggthemes)
library(spData)
library(gganimate)
library(readr)
library(readxl)
library(spData)
library(plotly)
library(sf)
library(viridis)
library(ggcharts)
library(ggrepel)
library(cowplot)
library(gapminder)
library(plm)


#puaxando a dataset_total e a dataset_total_index
dataset_total <- read.csv("dataset_total.csv") 

dataset_total_index <- read.csv("dataset_total_index.csv") 
head(dataset_total, 10)
```



What follows is the details on some of the variables above shown:

* **Total general government gross debt** - accounts for the debt of the central, local and state governments. The definition of debt here is broad - as Arslanalp and Tsuda (2012) points out - and includes: i) currency and deposits; ii) securities; and iii) loans. Measured in billions of national currency.

* **Subgroups from total debt** - total general government gross debt is divided into six groups concerning the beholder of the asset, those groups are:

 - *Foreing central banks*;
 - *Foreign banks*;
 - *Foreing non-banks*;
 
 - *Domestic central bank*;
 - *Domestic banks*;
 - *Domestic non-banks*.

* **GDP constant** - Annual percentages of constant price GDP are year-on-year changes; the base year is country-specific. Expenditure-based GDP is total final expenditures at purchasersâ prices (including the f.o.b. value of exports of goods and services), less the f.o.b. value of imports of goods and services; 

* **GDP current** - These data form the basis for the country weights used to generate the World Economic Outlook country group composites for the domestic economy;  

* **GDP per capita constant** - GDP is expressed in constant international dollars per person. Data are derived by dividing constant price purchasing-power parity (PPP) GDP by total population;

* **Inflation mean** - Annual percentages of average consumer prices are year-on-year changes;

* **Inflation end** - Annual percentages of end of period consumer prices are year-on-year changes;

* **Unemployment rate** - Defined by either the national definition, the ILO harmonized definition, or the OECD harmonized definition. The OECD harmonized unemployment rate gives the number of unemployed persons as a percentage of the labor force (the total number of people employed plus unemployed);

* **Lending-borrowing rate** - Net lending (+)/ borrowing (â) is calculated as revenue minus total expenditure. This is a core GFS balance that measures the extent to which general government is either putting financial resources at the disposal of other sectors in the economy and nonresidents (net lending), or utilizing the financial resources generated by other sectors and nonresidents (net borrowing);

* **Account balance** - Current account is all transactions other than those in financial and capital items. The major classifications are goods and services, income and current transfers. The focus of the BOP is on transactions (between an economy and the rest of the world) in goods, services, and income;

* **Develop** Variable to distinguish emerging markets (EM) and advanced markets (AM);

* **Taxes** Tax aliquote for each country;

* **VIX (EUA)** Year average for the Volatility Index (VIX) is a measure of expected price fluctuations in the S&P 500 Index options;

* **VIX (EUR)** Year average for the EuroCurrency Volatility Index ("Euro VIX") measures the market's expectation volatility of the $US/Euro exchange rate;

* **Nominal Rate** Annual nominal interest rate;

* **GDP per capita in current USD**.



## Ranking 

```{r , echo=FALSE, message=FALSE}

  dataset_total %>%
  filter(year %in% c(2004, 2009, 2014, 2019), !is.na(develop)) %>%
  bar_chart(x = country, y = debt_to_GDP_, facet = year, top_n = 15, fill = develop) +
  labs( x = "", y = "Debt to GDP (%)",
  title = "Top 15 Debt to GDP", fill = "Develop") +
  theme_classic() +
  scale_fill_manual("Develop", values = c("EM" = "red4", "AM" = "navyblue"))+
  theme(legend.title = element_text(face = "bold", size = 10)) 


```



```{r , echo=FALSE, message=FALSE}

dataset_total %>%
  mutate(f_debt = foreign_debt_*fx_) %>% 
  filter(year %in% c(2004, 2009, 2014, 2019), !is.na(develop)) %>%
  bar_chart(x = country, y = (f_debt), facet = year, top_n = 15, fill = develop) +  
  labs( x = "", y = "Debt held by Foreign Investors (Billions USD)",
  title = "Top 15 countries with debt held by Foreign Investors", fill = "Develop") +
  theme_classic() +
  theme(legend.title = element_text(face = "bold", size = 10)) +
  scale_fill_manual("Develop", values = c("EM" = "red4", "AM" = "navyblue"))

```



# Stylized Facts

Firstly, some stylized facts will be explained in relation to our dataset.


## Countries have different indebtedness levels

```{r , echo=FALSE, message=FALSE}

mundo <- world %>%
  mutate(name_long = str_replace_all(string = name_long, pattern = "Russian Federation", replacement = "Russia"),
         name_long = str_replace_all(string = name_long, pattern = "Republic of Korea", replacement = "Korea"))

mundo <- mundo %>% 
  select(-c('continent':'gdpPercap')) %>% 
  rename(country = name_long) %>% 
  full_join(dataset_total, by = "country") %>% 
  mutate(debt_to_GDP_ = as.numeric(debt_to_GDP_))

mundo %>% 
  ggplot() +
  geom_sf(data = mundo, aes(geometry = geom), fill = "lightgrey") +
  geom_sf(aes(fill = debt_to_GDP_)) +
  scale_fill_viridis_c(name = "(%)", option = "magma", trans = "sqrt", direction = -1) +
  ggtitle("Debt to GDP") +
  labs(subtitle = "Mean 2004-2019") +
  theme_map() +
  theme(panel.background = element_rect(fill = "white"),
        legend.title = element_text(face = "bold", size = 10),
        legend.background = element_rect(fill = NA),
        plot.title = element_text(face = "bold", size = 17)) +
  #transition_states(year,
                      #transition_length = 2,
                      #state_length = 1) +
  coord_sf(ylim = c(-50, 90))

legend.title = element_text(colour="blue", size=10, 
                            face="bold")
  

```

As the map shown above makes clear, countries around the world have contrasting levels of debt to GDP. Nations in grey are not part of our sample. 


## The level of indebtedness in the world has varied considerably in recent years
```{r , echo=FALSE, message=FALSE}

 graph_debt <- dataset_total %>% 
  group_by(year) %>%
   filter(!is.na(develop)) %>% 
  summarise(debt_to_GDP_mean = mean(debt_to_GDP_)) %>% 
ggplot(aes(x = year, y = debt_to_GDP_mean)) +
    geom_point() +
     geom_smooth(color="black")+
    labs(x = "Year", y = "Debt to GDP Ratio (%)", title = "Average Debt to GDP Ratio for 45 Countries") +
    theme_light()

graph_debt


```


It is possible to observe that the average indebtedness in the countries fell a lot in 2008, rise until 2018 and has been showing a slight drop.


## Advanced markets are more indebted than emerging markets

```{r, echo=FALSE, message=FALSE}
 graph_debt_sep<-dataset_total %>% 
   filter(!is.na(develop)) %>% 
   rename(Type=25) %>% 
  group_by(year, Type) %>% 
  summarise(debt_to_GDP_mean = mean(debt_to_GDP_)) %>% 
ggplot(aes(x = year, y = debt_to_GDP_mean, color=Type )) +
   scale_color_manual(values = c("EM" = "red4", "AM" = "navyblue"))+
    geom_point() +
    geom_smooth()+
    labs(x = "Year", y = "Debt to GDP Ratio (%)", title = "Average Debt to GDP Ratio for Advanced and Emerging Markets") +
    theme_light()

graph_debt_sep

```


## The relationship between debt and GDP is not clear



```{r, echo=FALSE, message=FALSE, warning=FALSE}

 graph_debt_GDP <- dataset_total %>% 
   group_by(country) %>% 
   filter(!is.na(develop)) %>% 
  summarise(debt_to_GDP_mean = mean(debt_to_GDP_) , GDP_per_cap_mean = mean(GDP_per_cap_cur_USD)) %>% 
ggplot(aes(x = GDP_per_cap_mean, y = debt_to_GDP_mean, color=country)) +
    scale_color_viridis_d() +
    geom_point(show.legend = FALSE) +
    labs(x = "GDP per Capita (USD)", y = "Debt to GDP Ratio (%)", title = " Average for 45 Countries (2004-2019)") +
    theme_bw()

 

```


Even though advanced markets have a higher debt level than emerging markets, the relationship between GDP per capita and debt to GDP ratio is not clear.


## It is not possible to observe that countries with more than 90% debt to GDP grow less  

```{r, echo=FALSE, message=FALSE}

dataset_total %>% 
    filter(year >= 2008, develop == "AM") %>% 
    mutate(GDP_var = ifelse(year == 2019, (GDP_cte - lag(GDP_cte, k = 10))/(lag(GDP_cte, k = 10)), NA)) %>%
    group_by(country) %>% 
    mutate(media_debt_GDP = mean(debt_to_GDP_)) %>% 
    filter(year == 2019, !is.na(develop)) %>% 
    ggplot() +
    geom_point(aes(x = media_debt_GDP, y = GDP_var), colour = "black") +
    geom_text(aes(x = media_debt_GDP, y = GDP_var, colour = country, label = country, fontface = 2),
              hjust = 0, vjust = 0, size = 4) +
    geom_vline(xintercept = 90, linetype="dashed", colour = "red4", size = 1) +
    labs(title = "Relation between debt and growth - Advanced markets",
         subtitle = "(2009-2019)") +
    theme_bw() +
    theme(legend.position = "none", plot.title = element_text(size = 15)) +
    xlab("Debt to GDP (%)") +
    ylab("GDP growth")

```


Contrasting with Reinhart and Rogoff (2010), this dataset does not show a clear pattern of decreasing GDP growth beyond the 90% debt to GDP level for advanced economies (marked in red). 

```{r, echo=FALSE, message=FALSE}


dataset_total %>% 
    filter(year >= 2008, develop == "EM") %>% 
    mutate(GDP_var = ifelse(year == 2019, (GDP_cte - lag(GDP_cte, k = 10))/(lag(GDP_cte, k = 10)), NA)) %>%
    group_by(country) %>% 
    mutate(media_debt_GDP = mean(debt_to_GDP_)) %>% 
    filter(year == 2019, !is.na(develop)) %>% 
    ggplot() +
    geom_point(aes(x = media_debt_GDP, y = GDP_var), colour = "black") +
    geom_text(aes(x = media_debt_GDP, y = GDP_var, colour = country, label = country, fontface = 2),
              hjust = 0, vjust = 0, size = 4) +
    labs(title = "Relation between debt and growth - Emerging markets",
         subtitle = "(2009-2019)") +
    theme_bw() +
    theme(legend.position = "none", plot.title = element_text(size = 15)) +
    xlab("Debt to GDP (%)") +
    ylab("GDP growth")
 
```


Concerning emerging economies, Reinhart et. al (2003) finds that real growth might be constrained even with low levels of indebtedness - such as 15 or 20%. Once again, the selection of countries and time space here goes in a different direction.


## Foreign investors have a preference for allocating their resources to advanced market bond

```{r, echo=FALSE, message=FALSE}
 
graph_debt_foreign_sep<-dataset_total %>% 
   filter(!is.na(develop)) %>% 
   rename(Type=25) %>% 
  mutate(foreign_debt_USD=(foreign_debt_*fx_)) %>% 
  group_by(year, Type) %>% 
  summarise(debt_foreign_mean = mean(foreign_debt_USD)) %>% 
ggplot(aes(x = year, y = debt_foreign_mean, color=Type )) +
   scale_color_manual(values = c("EM" = "red4", "AM" = "navyblue"))+
    geom_point() +
    geom_smooth()+
    labs(x = "Year", y = "Government Debt Held by Foreign Investors (Billion USD)", title = "Total Debt Held by Foreign Investors for Advanced and Emerging Markets") +
    theme_bw()

graph_debt_foreign_sep
```


It is possible to observe that foreign investors have allocated much more resources in bonds from advanced markets. In addition, we can see that since 2012, the participation of foreign investors in government bonds has accelerated.


## The participation of domestic investors in the composition of debt it is not invariant over time

```{r, echo=FALSE, message=FALSE}
 graph_debt_domestic_sep<-dataset_total %>% 
   filter(!is.na(develop)) %>% 
   rename(Type=25) %>% 
  mutate(domestic_debt_USD_prop=(domestic_debt_/total_debt_)) %>% 
  group_by(year, Type) %>% 
  summarise(debt_domestic_mean = mean(domestic_debt_USD_prop)) %>% 
ggplot(aes(x = year, y = debt_domestic_mean, color=Type )) +
   scale_color_manual(values = c("EM" = "red4", "AM" = "navyblue"))+
    geom_point() +
    geom_smooth()+
    labs(x = "Year", y = "Government Debt Held by Domestic Investors (%)", title = "Debt Held by Domestic Investors for Advanced and Emerging Markets") +
    theme_bw()

 graph_debt_domestic_sep

```


In addition to the domestic participation in debt varying for both emerging and advanced countries, it is possible to infer that those variations are inverse.


## The participation of domestic investors in the composition of debt it is not invariant over time

```{r, echo=FALSE, message=FALSE}
 graph_debt_foreign_sep<-dataset_total %>% 
   filter(!is.na(develop)) %>% 
   rename(Type=25) %>% 
  mutate(foreign_debt_USD_prop=(foreign_debt_/total_debt_)) %>% 
  group_by(year, Type) %>% 
  summarise(debt_foreign_mean = mean(foreign_debt_USD_prop)) %>% 
ggplot(aes(x = year, y = debt_foreign_mean, color=Type )) +
   scale_color_manual(values = c("EM" = "red4", "AM" = "navyblue"))+
    geom_point() +
    geom_smooth()+
    labs(x = "Year", y = "Government Debt Held by Foreign Investors (%)", title = "Debt Held by Foreign Investors for Advanced and Emerging Markets") +
    theme_bw()

 graph_debt_foreign_sep

```

## There is no clear relationship between debt and inflation

```{r, echo=FALSE, message=FALSE, warning=FALSE}

graph_debt_inflation <-  dataset_total %>% 
  filter(!is.na(develop)) %>% 
  ggplot() + 
  geom_point(aes(inflation_mean, (total_debt_*fx_), colour = develop)) +
  xlim(0,40)+
  ylim(0,400) +
  labs(x = "Annual Inflation Rate (%)", y = "Total Debt (Billion USD)", title = "Total Debt X Inflation", subtitle = "45 countries (2004-2019)" ) + 
  theme_bw()+
scale_colour_manual("Develop", values = c("EM" = "red4", "AM" = "navyblue")) 

graph_debt_inflation

```


#Econometrics

```{r, echo=FALSE, message=FALSE, warning=FALSE}

panel_dataset <- plm.data(dataset_total, index=c("country", "year"))

panel_dataset <- panel_dataset %>% 
  mutate(for_part = (foreign_debt_/total_debt_))

panel_dataset <- panel_dataset %>% 
  mutate(for_ex_BC = ((nonbank_foreign_debt_ + bank_foreign_debt_)/total_debt_))

panel_dataset <- panel_dataset %>% 
  rename(lending_borrow=23)

```


##REG 1
```{r,  echo=FALSE, message=FALSE, warning=FALSE}

reg1 <- plm(for_ex_BC ~  debt_to_GDP_ + log(debt_to_GDP_) + log(debt_to_GDP_) + fx_ + GDP_per_cap_cte + inflation_mean +  nominal_rate + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment, data=panel_dataset )

summary(reg1)

```






##REG 1.1
```{r}

reg1.1 <- plm(for_ex_BC ~ total_debt_ + log(foreign_debt_) + debt_to_GDP_ + fx_ + GDP_per_cap_cte + nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean, data = panel_dataset )

summary(reg1.1)

```


##REG 2.1
```{r}

reg2.1 <- plm(for_ex_BC ~ log(foreign_debt_) + debt_to_GDP_ + fx_ + GDP_per_cap_cte + nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean, data = panel_dataset )

summary(reg2.1)

```

##REG 3.1
```{r}

reg3.1 <- plm(for_ex_BC ~ total_debt_ + debt_to_GDP_ + fx_ + GDP_per_cap_cte + nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean, data = panel_dataset )

summary(reg3.1)

```

##REG 4.1
```{r}

reg4.1 <- plm(for_ex_BC ~ debt_to_GDP_ + fx_ + GDP_per_cap_cte + nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean, data = panel_dataset )

summary(reg4.1)

```


##REG 5.1
```{r}

reg5.1 <- plm(for_ex_BC ~ total_debt_ + log(foreign_debt_) + debt_to_GDP_ + GDP_per_cap_cte + nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean, data = panel_dataset )

summary(reg5.1)

```

##REG 6.1
```{r}

reg6.1 <- plm(for_ex_BC ~ total_debt_ + log(foreign_debt_) + debt_to_GDP_ + fx_ + nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean, data = panel_dataset )

summary(reg6.1)

```

##REG 7.1
```{r}

reg7.1 <- plm(for_ex_BC ~ total_debt_ + log(foreign_debt_) + debt_to_GDP_ + fx_ + GDP_per_cap_cte + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean, data = panel_dataset )

summary(reg7.1)

```

##REG 8.1
```{r}

reg8.1 <- plm(for_ex_BC ~ total_debt_ + log(foreign_debt_) + debt_to_GDP_ + fx_ + GDP_per_cap_cte + nominal_rate + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean, data = panel_dataset )

summary(reg8.1)

```

##REG 9.1
```{r}

reg9.1 <- plm(for_ex_BC ~ total_debt_ + log(foreign_debt_) + debt_to_GDP_ + fx_ + GDP_per_cap_cte + nominal_rate + continent + vix_EUA + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean, data = panel_dataset )

summary(reg9.1)

```

##REG 10.1
```{r}

reg10.1 <- plm(for_ex_BC ~ total_debt_ + log(foreign_debt_) + debt_to_GDP_ + fx_ + GDP_per_cap_cte + nominal_rate + continent + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean, data = panel_dataset )

summary(reg10.1)

```

##REG 11.1
```{r}

reg11.1 <- plm(for_ex_BC ~ total_debt_ + log(foreign_debt_) + debt_to_GDP_ + fx_ + GDP_per_cap_cte + nominal_rate + continent + vix_EUA + vix_EUR + develop + account_balance + lending_borrow + unemployment + inflation_mean, data = panel_dataset )

summary(reg11.1)

```

##REG 12.1
```{r}

reg12.1 <- plm(for_ex_BC ~ total_debt_ + log(foreign_debt_) + debt_to_GDP_ + fx_ + GDP_per_cap_cte + nominal_rate + continent + vix_EUA + vix_EUR + taxes + account_balance + lending_borrow + unemployment + inflation_mean, data = panel_dataset )

summary(reg12.1)

```

##REG 13.1
```{r}

reg13.1 <- plm(for_ex_BC ~ total_debt_ + log(foreign_debt_) + debt_to_GDP_ + fx_ + GDP_per_cap_cte + nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + lending_borrow + unemployment + inflation_mean, data = panel_dataset )

summary(reg13.1)

```

##REG 14.1
```{r}

reg14.1 <- plm(for_ex_BC ~ total_debt_ + log(foreign_debt_) + debt_to_GDP_ + fx_ + GDP_per_cap_cte + nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + unemployment + inflation_mean, data = panel_dataset )

summary(reg14.1)

```

##REG 15.1
```{r}

reg15.1 <- plm(for_ex_BC ~ total_debt_ + log(foreign_debt_) + debt_to_GDP_ + fx_ + GDP_per_cap_cte + nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + inflation_mean, data = panel_dataset )

summary(reg15.1)

```

##REG 16.1
```{r}

reg16.1 <- plm(for_ex_BC ~ total_debt_ + log(foreign_debt_) + debt_to_GDP_ + fx_ + GDP_per_cap_cte + nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment, data = panel_dataset )

summary(reg16.1)

```


##REG 17.1
```{r}

reg17.1 <- plm(for_ex_BC ~ total_debt_ + log(foreign_debt_) + debt_to_GDP_ + GDP_per_cap_cte + nominal_rate + continent + taxes + develop + unemployment + inflation_mean, data = panel_dataset )

summary(reg17.1)

```

##REG 18.1
```{r}

reg18.1 <- plm(for_ex_BC ~ total_debt_ + log(foreign_debt_) + debt_to_GDP_ + GDP_per_cap_cte + nominal_rate + continent + taxes + develop + unemployment, data = panel_dataset )

summary(reg18.1)

```

##REG 19.1
```{r}

reg19.1 <- plm(for_ex_BC ~ total_debt_ + log(foreign_debt_) + debt_to_GDP_ + GDP_per_cap_cte + continent + taxes + develop + unemployment, data = panel_dataset )

summary(reg19.1)

```

##REG 20.1
```{r}

reg20.1 <- plm(for_ex_BC ~ total_debt_ + log(foreign_debt_) + debt_to_GDP_*develop + GDP_per_cap_cte + nominal_rate + continent + taxes + develop + unemployment, data = panel_dataset )

summary(reg20.1)

```
