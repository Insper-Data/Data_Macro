select("country", "year", "foreign_debt_perc" ) %>%
group_by(country) %>%
mutate(foreign_debt_perc_var = foreign_debt_perc - dplyr::lag(foreign_debt_perc)) %>% view()
graph_debt_foreign_p <- dataset_total %>%
filter(!is.na(develop)) %>%
filter(develop=="EM") %>%
mutate(foreign_debt_perc=(foreign_debt_/total_debt_)) %>%
select("country", "year", "foreign_debt_perc" ) %>%
group_by(country) %>%
mutate(foreign_debt_perc_var = foreign_debt_perc - dplyr::lag(foreign_debt_perc)) %>%
mutate(mean(foreign_debt_perc_var))
graph_debt_foreign_p <- dataset_total %>%
filter(!is.na(develop)) %>%
filter(develop=="EM") %>%
mutate(foreign_debt_perc=(foreign_debt_/total_debt_)) %>%
select("country", "year", "foreign_debt_perc" ) %>%
group_by(country) %>%
mutate(foreign_debt_perc_var = foreign_debt_perc - dplyr::lag(foreign_debt_perc)) %>%
mutate(mean= mean(foreign_debt_perc_var))
debugSource('~/Documents/InsperData/Macro /Teste de graficos.R', echo=TRUE)
graph_debt_foreign_p <- dataset_total %>%
filter(!is.na(develop)) %>%
filter(develop=="EM") %>%
mutate(foreign_debt_perc=(foreign_debt_/total_debt_)) %>%
select("country", "year", "foreign_debt_perc" ) %>%
group_by(country) %>%
mutate(foreign_debt_perc_var = foreign_debt_perc - dplyr::lag(foreign_debt_perc)) %>%
mutate(mean= mean(foreign_debt_perc_var)) %>% view()
graph_debt_foreign_p <- dataset_total %>%
filter(!is.na(develop)) %>%
filter(develop=="EM") %>%
mutate(foreign_debt_perc=(foreign_debt_/total_debt_)) %>%
select("country", "year", "foreign_debt_perc" ) %>%
group_by(country) %>%
mutate(foreign_debt_perc_var = foreign_debt_perc - dplyr::lag(foreign_debt_perc)) %>%
group_by(country) %>%
mutate(mean= mean(foreign_debt_perc_var)) %>% view()
graph_debt_foreign_p <- dataset_total %>%
filter(!is.na(develop)) %>%
filter(develop=="EM") %>%
mutate(foreign_debt_perc=(foreign_debt_/total_debt_)) %>%
select("country", "year", "foreign_debt_perc" ) %>%
group_by(country) %>%
mutate(foreign_debt_perc_var = foreign_debt_perc - dplyr::lag(foreign_debt_perc)) %>%
group_by(country) %>%
mutate(mean_= mean(foreign_debt_perc_var)) %>% view()
graph_debt_foreign_p <- dataset_total %>%
filter(!is.na(develop)) %>%
filter(develop=="EM") %>%
mutate(foreign_debt_perc=(foreign_debt_/total_debt_)) %>%
select("country", "year", "foreign_debt_perc" ) %>%
group_by(country) %>%
mutate(foreign_debt_perc_var = foreign_debt_perc - dplyr::lag(foreign_debt_perc)) %>%
group_by(country) %>%
mutate(mean_= mean(foreign_debt_perc_var, na.rm = TRUE)) %>% view()
graph_debt_foreign_p <- dataset_total %>%
filter(!is.na(develop)) %>%
filter(develop=="EM") %>%
mutate(foreign_debt_perc=(foreign_debt_/total_debt_)) %>%
select("country", "year", "foreign_debt_perc" ) %>%
group_by(country) %>%
mutate(foreign_debt_perc_var = foreign_debt_perc - dplyr::lag(foreign_debt_perc)) %>%
group_by(country) %>%
mutate(mean_= mean(foreign_debt_perc_var, na.rm = TRUE), round=2) %>% view()
graph_debt_foreign_p <- dataset_total %>%
filter(!is.na(develop)) %>%
filter(develop=="EM") %>%
mutate(foreign_debt_perc=(foreign_debt_/total_debt_)) %>%
select("country", "year", "foreign_debt_perc" ) %>%
group_by(country) %>%
mutate(foreign_debt_perc_var = foreign_debt_perc - dplyr::lag(foreign_debt_perc)) %>%
group_by(country) %>%
mutate(var_= var(foreign_debt_perc_var, na.rm = TRUE)) %>% view()
graph_debt_foreign_p <- dataset_total %>%
filter(!is.na(develop)) %>%
filter(develop=="EM") %>%
mutate(foreign_debt_perc=(foreign_debt_/total_debt_)) %>%
select("country", "year", "foreign_debt_perc" ) %>%
group_by(country) %>%
mutate(foreign_debt_perc_var = foreign_debt_perc - dplyr::lag(foreign_debt_perc)) %>%
group_by(country) %>%
mutate(var_= var(foreign_debt_perc_var, na.rm = TRUE)) %>%
mutate(var_per= var(foreign_debt_perc, na.rm = TRUE)) %>%view()
graph_debt_foreign_more <- dataset_total %>%
filter(!is.na(develop)) %>%
filter(develop=="EM") %>%
filter(country %in% c("Argentina", "Bulgaria","Colombia","Indonesia","Mexico","Peru","Poland", "Romania", "Ukraine","Uruguay") )%>%
mutate(foreign_debt_perc=(foreign_debt_/total_debt_)*100) %>%
ggplot(aes(x = year, y = foreign_debt_perc, color=country)) +
geom_smooth(se = FALSE)+
labs(x = "Year", y = "Foreign Investors (%)", title = "Total Debt Held by Foreign Investors for Emerging Markets", subtitle = "Emerging markets with more than 40% of Foreign Investors in 2019") +
theme_bw()
graph_debt_foreign_less <- dataset_total %>%
filter(!is.na(develop)) %>%
filter(develop=="EM") %>%
filter(country %in% c("Brazil", "Chile","China","Egypt","Hungary","India","Malaysia", "Philippines", "Russia","South Africa", "Thailand", "Turkey") )%>%
mutate(foreign_debt_perc=(foreign_debt_/total_debt_)*100) %>%
ggplot(aes(x = year, y = foreign_debt_perc, color=country)) +
geom_smooth(se = FALSE)+
labs(x = "Year", y = "Foreign Investors (%)", title = "Total Debt Held by Foreign Investors for Emerging Markets", subtitle = "Emerging markets with less than 40% of Foreign Investors in 2019") +
theme_bw()
graph_debt_foreign_more
graph_debt_foreign_less
graph_debt_foreign_more <- dataset_total %>%
filter(!is.na(develop)) %>%
filter(develop=="EM") %>%
filter(country %in% c("Argentina", "Bulgaria","Colombia","Indonesia","Mexico","Peru","Poland", "Romania", "Ukraine","Uruguay") )%>%
mutate(foreign_debt_perc=(foreign_debt_/total_debt_)*100) %>%
ggplot(aes(x = year, y = foreign_debt_perc, color=country)) +
geom_smooth(se = FALSE)+
labs(x = "Year", y = "Foreign Investors (%)", title = "Total Debt Held by Foreign Investors for Emerging Markets", subtitle = "Emerging markets with more than 40% of Foreign Investors in 2019") +
theme_bw()
graph_debt_foreign_less <- dataset_total %>%
filter(!is.na(develop)) %>%
filter(develop=="EM") %>%
filter(country %in% c("Brazil", "Chile","China","Egypt","Hungary","India","Malaysia", "Philippines", "Russia","South Africa", "Thailand", "Turkey") )%>%
mutate(foreign_debt_perc=(foreign_debt_/total_debt_)*100) %>%
ggplot(aes(x = year, y = foreign_debt_perc, color=country)) +
geom_smooth(se = FALSE)+
labs(x = "Year", y = "Foreign Investors (%)", title = "Total Debt Held by Foreign Investors for Emerging Markets", subtitle = "Emerging markets with less than 40% of Foreign Investors in 2019") +
theme_bw()
graph_debt_foreign_more
graph_debt_foreign_less
graph_debt_foreign_p <- dataset_total %>%
filter(!is.na(develop)) %>%
filter(develop=="EM") %>%
mutate(foreign_debt_perc=(foreign_debt_/total_debt_)) %>%
select("country", "year", "foreign_debt_perc" ) %>%
group_by(country) %>%
mutate(foreign_debt_perc_var = foreign_debt_perc - dplyr::lag(foreign_debt_perc, k=16)) %>%
ggplot(aes(x = year, y = foreign_debt_perc_var, color=country )) +
geom_line() +
labs(x = "Year", y = "Variation of Foreign Investors (p.p.)", title = "Variation of Foreign Investors for Emerging Markets")
theme_bw()
graph_debt_foreign_p
graph_debt_foreign_p <- dataset_total %>%
filter(!is.na(develop)) %>%
filter(develop=="EM") %>%
mutate(foreign_debt_perc=(foreign_debt_/total_debt_)) %>%
select("country", "year", "foreign_debt_perc" ) %>%
group_by(country) %>%
mutate(foreign_debt_perc_var = ifelse(year == 2019,(foreign_debt_perc - dplyr::lag(foreign_debt_perc, k=16)), NA)) %>%
ggplot(aes(x = year, y = foreign_debt_perc_var, color=country )) +
geom_line() +
labs(x = "Year", y = "Variation of Foreign Investors (p.p.)", title = "Variation of Foreign Investors for Emerging Markets")
theme_bw()
graph_debt_foreign_p
graph_debt_foreign_p <- dataset_total %>%
filter(!is.na(develop)) %>%
filter(develop=="EM") %>%
mutate(foreign_debt_perc=(foreign_debt_/total_debt_)) %>%
select("country", "year", "foreign_debt_perc" ) %>%
group_by(country) %>%
mutate(foreign_debt_perc_var = ifelse(year == 2019,(foreign_debt_perc - dplyr::lag(foreign_debt_perc, k=15)), NA)) %>%
ggplot(aes(x = year, y = foreign_debt_perc_var, color=country )) +
geom_line() +
labs(x = "Year", y = "Variation of Foreign Investors (p.p.)", title = "Variation of Foreign Investors for Emerging Markets")
theme_bw()
graph_debt_foreign_p
graph_debt_foreign_p <- dataset_total %>%
filter(!is.na(develop)) %>%
filter(develop=="EM") %>%
mutate(foreign_debt_perc=(foreign_debt_/total_debt_)) %>%
select("country", "year", "foreign_debt_perc" ) %>%
group_by(country) %>%
mutate(foreign_debt_perc_var = ifelse(year == 2019,(foreign_debt_perc - dplyr::lag(foreign_debt_perc, k=14)), NA)) %>%
ggplot(aes(x = year, y = foreign_debt_perc_var, color=country )) +
geom_line() +
labs(x = "Year", y = "Variation of Foreign Investors (p.p.)", title = "Variation of Foreign Investors for Emerging Markets")
theme_bw()
graph_debt_foreign_p
graph_debt_foreign_p <- dataset_total %>%
filter(!is.na(develop)) %>%
filter(develop=="EM") %>%
mutate(foreign_debt_perc=(foreign_debt_/total_debt_)) %>%
select("country", "year", "foreign_debt_perc" ) %>%
group_by(country) %>%
mutate(foreign_debt_perc_var = ifelse(year == 2019,(foreign_debt_perc - dplyr::lag(foreign_debt_perc, k=14)), NA)) %>% view()
graph_debt_foreign_p <- dataset_total %>%
filter(!is.na(develop)) %>%
filter(develop=="EM") %>%
mutate(foreign_debt_perc=(foreign_debt_/total_debt_)) %>%
select("country", "year", "foreign_debt_perc" ) %>%
group_by(country) %>%
mutate(foreign_debt_perc_var = ifelse(year == 2019,(foreign_debt_perc - dplyr::lag(foreign_debt_perc, k=15)), NA)) %>% view()
View(dataset_total)
graph_debt_foreign_min <- dataset_total %>%
filter(!is.na(develop)) %>%
filter(develop=="EM", continent=="Asia") %>%
mutate(foreign_debt_perc=(foreign_debt_/total_debt_)) %>%
ggplot(aes(x = year, y = foreign_debt_perc, color=country)) +
geom_smooth(se = FALSE)+
labs(x = "Year", y = "Government Debt Held by Foreign Investors (%)", title = "Total Debt Held by Foreign Investors for Emerging Markets", subtitle = "Emerging markets with less than 40% of Foreign Investors in 2019") +
theme_bw()
graph_debt_foreign_min
graph_debt_foreign_africa <- dataset_total %>%
filter(!is.na(develop)) %>%
filter(develop=="EM", continent=="Africa") %>%
mutate(foreign_debt_perc=(foreign_debt_/total_debt_)*100) %>%
ggplot(aes(x = year, y = foreign_debt_perc, color=country)) +
geom_smooth(se = FALSE)+
labs(x = "Year", y = "Government Debt Held by Foreign Investors (%)", title = "Total Debt Held by Foreign Investors for Emerging Markets", subtitle = "Africa") +
theme_bw()
graph_debt_foreign_africa
graph_debt_foreign_europe <- dataset_total %>%
filter(!is.na(develop)) %>%
filter(develop=="EM", continent=="Europe") %>%
mutate(foreign_debt_perc=(foreign_debt_/total_debt_)*100) %>%
ggplot(aes(x = year, y = foreign_debt_perc, color=country)) +
geom_smooth(se = FALSE)+
labs(x = "Year", y = "Government Debt Held by Foreign Investors (%)", title = "Total Debt Held by Foreign Investors for Emerging Markets", subtitle = "Europe") +
theme_bw()
graph_debt_foreign_europe
graph_debt_foreign_asia <- dataset_total %>%
filter(!is.na(develop)) %>%
filter(develop=="EM", continent=="Asia" & "Africa") %>%
mutate(foreign_debt_perc=(foreign_debt_/total_debt_)*100) %>%
ggplot(aes(x = year, y = foreign_debt_perc, color=country)) +
geom_smooth(se = FALSE)+
labs(x = "Year", y = "Government Debt Held by Foreign Investors (%)", title = "Total Debt Held by Foreign Investors for Emerging Markets", subtitle = "Asia") +
theme_bw()
graph_debt_foreign_asia
graph_debt_foreign_asia <- dataset_total %>%
filter(!is.na(develop)) %>%
filter(develop=="EM", continent=="Asia", continent== "Africa") %>%
mutate(foreign_debt_perc=(foreign_debt_/total_debt_)*100) %>%
ggplot(aes(x = year, y = foreign_debt_perc, color=country)) +
geom_smooth(se = FALSE)+
labs(x = "Year", y = "Government Debt Held by Foreign Investors (%)", title = "Total Debt Held by Foreign Investors for Emerging Markets", subtitle = "Asia") +
theme_bw()
graph_debt_foreign_asia
graph_debt_foreign_asia <- dataset_total %>%
filter(!is.na(develop)) %>%
filter(develop=="EM", continent=="Asia" & continent=="Africa") %>%
mutate(foreign_debt_perc=(foreign_debt_/total_debt_)*100) %>%
ggplot(aes(x = year, y = foreign_debt_perc, color=country)) +
geom_smooth(se = FALSE)+
labs(x = "Year", y = "Government Debt Held by Foreign Investors (%)", title = "Total Debt Held by Foreign Investors for Emerging Markets", subtitle = "Asia") +
theme_bw()
graph_debt_foreign_asia
graph_debt_foreign_asia <- dataset_total %>%
filter(!is.na(develop)) %>%
filter(develop=="EM", continent %in% c("Asia", "Africa")) %>%
mutate(foreign_debt_perc=(foreign_debt_/total_debt_)*100) %>%
ggplot(aes(x = year, y = foreign_debt_perc, color=country)) +
geom_smooth(se = FALSE)+
labs(x = "Year", y = "Government Debt Held by Foreign Investors (%)", title = "Total Debt Held by Foreign Investors for Emerging Markets", subtitle = "Asia") +
theme_bw()
graph_debt_foreign_asia
graph_debt_foreign_samerica <- dataset_total %>%
filter(!is.na(develop)) %>%
filter(develop=="EM", continent=="South America") %>%
mutate(foreign_debt_perc=(foreign_debt_/total_debt_)*100) %>%
ggplot(aes(x = year, y = foreign_debt_perc, color=country)) +
geom_smooth(se = FALSE)+
labs(x = "Year", y = "Government Debt Held by Foreign Investors (%)", title = "Total Debt Held by Foreign Investors for Emerging Markets", subtitle = "South America") +
theme_bw()
graph_debt_foreign_samerica
graph_debt_foreign_lamerica <- dataset_total %>%
filter(!is.na(develop)) %>%
filter(develop=="EM", continent%in% c("South America", "North America")) %>%
mutate(foreign_debt_perc=(foreign_debt_/total_debt_)*100) %>%
ggplot(aes(x = year, y = foreign_debt_perc, color=country)) +
geom_smooth(se = FALSE)+
labs(x = "Year", y = "Government Debt Held by Foreign Investors (%)", title = "Total Debt Held by Foreign Investors for Emerging Markets", subtitle = "Latin America") +
theme_bw()
graph_debt_foreign_lamerica
graph_debt_foreign_asia <- dataset_total %>%
filter(!is.na(develop)) %>%
filter(develop=="EM", continent %in% c("Asia", "Africa")) %>%
mutate(foreign_debt_perc=(foreign_debt_/total_debt_)*100) %>%
ggplot(aes(x = year, y = foreign_debt_perc, color=country)) +
geom_smooth(se = FALSE)+
labs(x = "Year", y = "Government Debt Held by Foreign Investors (%)", title = "Total Debt Held by Foreign Investors for Emerging Markets", subtitle = "Asia e Africa") +
theme_bw()
graph_debt_foreign_asia
graph_debt_foreign_lamerica <- dataset_total %>%
filter(!is.na(develop)) %>%
filter(develop=="EM", continent%in% c("South America", "North America")) %>%
mutate(foreign_debt_perc=(foreign_debt_/total_debt_)*100) %>%
ggplot(aes(x = year, y = foreign_debt_perc, color=country)) +
geom_smooth(se = FALSE)+
labs(x = "Year", y = "Government Debt Held by Foreign Investors (%)", title = "Total Debt Held by Foreign Investors for Emerging Markets", subtitle = "Latin America") +
theme_bw()
graph_debt_foreign_lamerica
graph_debt_foreign_europe <- dataset_total %>%
filter(!is.na(develop)) %>%
filter(develop=="EM", continent=="Europe") %>%
mutate(foreign_debt_perc=(foreign_debt_/total_debt_)*100) %>%
ggplot(aes(x = year, y = foreign_debt_perc, color=country)) +
geom_smooth(se = FALSE)+
labs(x = "Year", y = "Government Debt Held by Foreign Investors (%)", title = "Total Debt Held by Foreign Investors for Emerging Markets", subtitle = "Europe") +
theme_bw()
graph_debt_foreign_europe
graph_debt_foreign_asia <- dataset_total %>%
filter(!is.na(develop)) %>%
filter(develop=="EM", continent %in% c("Asia", "Africa")) %>%
mutate(foreign_debt_perc=(foreign_debt_/total_debt_)*100) %>%
ggplot(aes(x = year, y = foreign_debt_perc, color=country)) +
geom_smooth(se = FALSE)+
labs(x = "Year", y = "Government Debt Held by Foreign Investors (%)", title = "Total Debt Held by Foreign Investors", subtitle = "Emerging Markets - Asia e Africa") +
theme_bw()
graph_debt_foreign_lamerica <- dataset_total %>%
filter(!is.na(develop)) %>%
filter(develop=="EM", continent%in% c("South America", "North America")) %>%
mutate(foreign_debt_perc=(foreign_debt_/total_debt_)*100) %>%
ggplot(aes(x = year, y = foreign_debt_perc, color=country)) +
geom_smooth(se = FALSE)+
labs(x = "Year", y = "Government Debt Held by Foreign Investors (%)", title = "Total Debt Held by Foreign Investors", subtitle = "Emerging Markets -Latin America") +
theme_bw()
graph_debt_foreign_europe <- dataset_total %>%
filter(!is.na(develop)) %>%
filter(develop=="EM", continent=="Europe") %>%
mutate(foreign_debt_perc=(foreign_debt_/total_debt_)*100) %>%
ggplot(aes(x = year, y = foreign_debt_perc, color=country)) +
geom_smooth(se = FALSE)+
labs(x = "Year", y = "Government Debt Held by Foreign Investors (%)", title = "Total Debt Held by Foreign Investors", subtitle = "Emerging Markets - Europe and Non-Europe") +
theme_bw()
graph_debt_foreign_lamerica
graph_debt_foreign_europe
graph_debt_foreign_asia
graph_debt_foreign_asia <- dataset_total %>%
filter(!is.na(develop)) %>%
filter(develop=="EM", continent %in% c("Asia", "Africa")) %>%
mutate(foreign_debt_perc=(foreign_debt_/total_debt_)*100) %>%
ggplot(aes(x = year, y = foreign_debt_perc, color=country)) +
geom_smooth(se = FALSE)+
labs(x = "Year", y = "Government Debt Held by Foreign Investors (%)", title = "Total Debt Held by Foreign Investors", subtitle = "Emerging Markets - Asia e Africa") +
theme_bw()
graph_debt_foreign_lamerica <- dataset_total %>%
filter(!is.na(develop)) %>%
filter(develop=="EM", continent%in% c("South America", "North America")) %>%
mutate(foreign_debt_perc=(foreign_debt_/total_debt_)*100) %>%
ggplot(aes(x = year, y = foreign_debt_perc, color=country)) +
geom_smooth(se = FALSE)+
labs(x = "Year", y = "Government Debt Held by Foreign Investors (%)", title = "Total Debt Held by Foreign Investors", subtitle = "Emerging Markets -Latin America") +
theme_bw()
graph_debt_foreign_europe <- dataset_total %>%
filter(!is.na(develop)) %>%
filter(develop=="EM", continent=="Europe") %>%
mutate(foreign_debt_perc=(foreign_debt_/total_debt_)*100) %>%
ggplot(aes(x = year, y = foreign_debt_perc, color=country)) +
geom_smooth(se = FALSE)+
labs(x = "Year", y = "Government Debt Held by Foreign Investors (%)", title = "Total Debt Held by Foreign Investors", subtitle = "Emerging Markets - Europe and Non-Europe") +
theme_bw()
graph_debt_foreign_lamerica
graph_debt_foreign_europe
graph_debt_foreign_asia
graph_debt_foreign_pp<-dataset_total %>%
filter(!is.na(develop)) %>%
rename(Type=25) %>%
mutate(foreign_debt_perc=(foreign_debt_/total_debt_)*100) %>%
group_by(year, Type) %>%
summarise(debt_foreign_pp_mean = mean(foreign_debt_perc)) %>%
ggplot(aes(x = year, y = debt_foreign_pp_mean, color=Type )) +
scale_color_manual(values = c("EM" = "red4", "AM" = "navyblue"))+
geom_point() +
geom_smooth()+
labs(x = "Year", y = "Government debt held by foreign investors (%)", title = "Total debt held by foreign investors for advanced and emerging markets") +
theme_bw()
graph_debt_foreign_pp
graph_debt_domestic_sep<-dataset_total %>%
filter(!is.na(develop)) %>%
rename(Type=25) %>%
mutate(domestic_debt_USD_prop=(domestic_debt_/total_debt_)*100) %>%
group_by(year, Type) %>%
summarise(debt_domestic_mean = mean(domestic_debt_USD_prop)) %>%
ggplot(aes(x = year, y = debt_domestic_mean, color=Type )) +
scale_color_manual(values = c("EM" = "red4", "AM" = "navyblue"))+
geom_point() +
geom_smooth()+
labs(x = "Year", y = "Government debt held by domestic investors (%)", title = "Total debt held by domestic investors for advanced and emerging markets") +
theme_bw()
graph_debt_domestic_sep
dataset_total %>%
mutate(f_debt = foreign_debt_*fx_) %>%
filter(year %in% c(2004, 2009, 2014, 2019), !is.na(develop)) %>%
bar_chart(x = country, y = (f_debt/1000), facet = year, top_n = 15, fill = develop) +
labs( x = "", y = "Foreign investors (Trillions USD)",
title = "Top 15 Countries with Debt Held by Foreign Investors", fill = "Develop") +
theme_classic() +
theme(legend.title = element_text(face = "bold", size = 10)) +
scale_fill_manual("Develop", values = c("EM" = "red4", "AM" = "navyblue"))
dataset_total %>%
filter(country==-"United States") %>%
mutate(f_debt = foreign_debt_*fx_) %>%
filter(year %in% c(2004, 2009, 2014, 2019), !is.na(develop)) %>%
bar_chart(x = country, y = (f_debt/1000), facet = year, top_n = 15, fill = develop) +
labs( x = "", y = "Foreign investors (Trillions USD)",
title = "Top 15 Countries with Debt Held by Foreign Investors", fill = "Develop") +
theme_classic() +
theme(legend.title = element_text(face = "bold", size = 10)) +
scale_fill_manual("Develop", values = c("EM" = "red4", "AM" = "navyblue"))
dataset_total %>%
filter(country %in% c(- "United States")) %>%
mutate(f_debt = foreign_debt_*fx_) %>%
filter(year %in% c(2004, 2009, 2014, 2019), !is.na(develop)) %>%
bar_chart(x = country, y = (f_debt/1000), facet = year, top_n = 15, fill = develop) +
labs( x = "", y = "Foreign investors (Trillions USD)",
title = "Top 15 Countries with Debt Held by Foreign Investors", fill = "Develop") +
theme_classic() +
theme(legend.title = element_text(face = "bold", size = 10)) +
scale_fill_manual("Develop", values = c("EM" = "red4", "AM" = "navyblue"))
dataset_total %>%
filter(country %in% c(-"United States")) %>%
mutate(f_debt = foreign_debt_*fx_) %>%
filter(year %in% c(2004, 2009, 2014, 2019), !is.na(develop)) %>%
bar_chart(x = country, y = (f_debt/1000), facet = year, top_n = 15, fill = develop) +
labs( x = "", y = "Foreign investors (Trillions USD)",
title = "Top 15 Countries with Debt Held by Foreign Investors", fill = "Develop") +
theme_classic() +
theme(legend.title = element_text(face = "bold", size = 10)) +
scale_fill_manual("Develop", values = c("EM" = "red4", "AM" = "navyblue"))
dataset_total %>%
mutate(f_debt = foreign_debt_*fx_) %>%
filter(year %in% c(2004, 2009, 2014, 2019), !is.na(develop)) %>%
bar_chart(x = country, y = (f_debt/1000), facet = year, top_n = 15, fill = develop) +
labs( x = "", y = "Foreign investors (Trillions USD)",
title = "Top 15 Countries with Debt Held by Foreign Investors", fill = "Develop") +
theme_classic() +
theme(legend.title = element_text(face = "bold", size = 10)) +
scale_fill_manual("Develop", values = c("EM" = "red4", "AM" = "navyblue"))
dataset_total %>%
mutate(f_debt = foreign_debt_*fx_) %>%
filter(year %in% c(2004, 2009, 2014, 2019), !is.na(develop)) %>%
bar_chart(x = country, y = (f_debt/1000), facet = year, top_n = 15, fill = develop) +
labs( x = "", y = "Foreign investors (Trillions USD)",
title = "Top 15 Countries with Debt Held by Foreign Investors", fill = "Develop") +
theme_classic() +
theme(legend.title = element_text(face = "bold", size = 10)) +
scale_fill_manual("Develop", values = c("EM" = "red4", "AM" = "navyblue"))
dataset_total %>%
mutate(foreign_debt_perc=(foreign_debt_/total_debt_)*100) %>%
filter(year %in% c(2004, 2009, 2014, 2019), !is.na(develop)) %>%
bar_chart(x = country, y = (foreign_debt_perc), facet = year, top_n = 15, fill = develop) +
labs( x = "", y = "Foreign investors (Trillions USD)",
title = "Top 15 Countries with Debt Held by Foreign Investors", fill = "Develop") +
theme_classic() +
theme(legend.title = element_text(face = "bold", size = 10)) +
scale_fill_manual("Develop", values = c("EM" = "red4", "AM" = "navyblue"))
dataset_total %>%
mutate(f_debt = foreign_debt_*fx_) %>%
filter(year %in% c(2004, 2009, 2014, 2019), !is.na(develop)) %>%
bar_chart(x = country, y = (f_debt/1000), facet = year, top_n = 15, fill = develop) +
labs( x = "", y = "Foreign investors (Trillions USD)",
title = "Top 15 Countries with Debt Held by Foreign Investors", fill = "Develop") +
theme_classic() +
theme(legend.title = element_text(face = "bold", size = 10)) +
scale_fill_manual("Develop", values = c("EM" = "red4", "AM" = "navyblue"))
dataset_total %>%
mutate(foreign_debt_perc=(foreign_debt_/total_debt_)*100) %>%
filter(year %in% c(2004, 2009, 2014, 2019), !is.na(develop)) %>%
bar_chart(x = country, y = (foreign_debt_perc), facet = year, top_n = 15, fill = develop) +
labs( x = "", y = "Foreign investors (%)",
title = "Top 15 Countries with Debt Held by Foreign Investors", fill = "Develop") +
theme_classic() +
theme(legend.title = element_text(face = "bold", size = 10)) +
scale_fill_manual("Develop", values = c("EM" = "red4", "AM" = "navyblue"))
dataset_total %>%
mutate(f_debt = foreign_debt_*fx_) %>%
filter(year %in% c(2004, 2009, 2014, 2019), !is.na(develop)) %>%
bar_chart(x = country, y = (f_debt/1000), facet = year, top_n = 10, fill = develop) +
labs( x = "", y = "Foreign investors (Trillions USD)",
title = "Top 15 Countries with Debt Held by Foreign Investors", fill = "Develop") +
theme_classic() +
theme(legend.title = element_text(face = "bold", size = 10)) +
scale_fill_manual("Develop", values = c("EM" = "red4", "AM" = "navyblue"))
dataset_total %>%
mutate(foreign_debt_perc=(foreign_debt_/total_debt_)*100) %>%
filter(year %in% c(2004, 2009, 2014, 2019), !is.na(develop)) %>%
bar_chart(x = country, y = (foreign_debt_perc), facet = year, top_n = 10, fill = develop) +
labs( x = "", y = "Foreign investors (%)",
title = "Top 15 Countries with Debt Held by Foreign Investors", fill = "Develop") +
theme_classic() +
theme(legend.title = element_text(face = "bold", size = 10)) +
scale_fill_manual("Develop", values = c("EM" = "red4", "AM" = "navyblue"))
dataset_total %>%
mutate(f_debt = foreign_debt_*fx_) %>%
filter(year %in% c(2004, 2009, 2014, 2019), !is.na(develop)) %>%
bar_chart(x = country, y = (f_debt/1000), facet = year, top_n = 15, fill = develop) +
labs( x = "", y = "Foreign investors (Trillions USD)",
title = "Top 15 Countries with Debt Held by Foreign Investors", fill = "Develop") +
theme_classic() +
theme(legend.title = element_text(face = "bold", size = 10)) +
scale_fill_manual("Develop", values = c("EM" = "red4", "AM" = "navyblue"))
dataset_total %>%
mutate(foreign_debt_perc=(foreign_debt_/total_debt_)*100) %>%
filter(year %in% c(2004, 2009, 2014, 2019), !is.na(develop)) %>%
bar_chart(x = country, y = (foreign_debt_perc), facet = year, top_n = 15, fill = develop) +
labs( x = "", y = "Foreign investors (%)",
title = "Top 15 Countries with Debt Held by Foreign Investors", fill = "Develop") +
theme_classic() +
theme(legend.title = element_text(face = "bold", size = 10)) +
scale_fill_manual("Develop", values = c("EM" = "red4", "AM" = "navyblue"))
dataset_total %>%
mutate(f_debt = foreign_debt_*fx_) %>%
filter(year %in% c(2004, 2009, 2014, 2019), !is.na(develop)) %>%
bar_chart(x = country, y = (f_debt/1000), facet = year, top_n = 15, fill = develop) +
labs( x = "", y = "Foreign investors (Trillions USD)",
title = "Top 15 Countries with Debt Held by Foreign Investors", fill = "Develop") +
theme_classic() +
theme(legend.title = element_text(face = "bold", size = 10)) +
scale_fill_manual("Develop", values = c("EM" = "red4", "AM" = "navyblue"))
dataset_total %>%
mutate(foreign_debt_perc=(foreign_debt_/total_debt_)*100) %>%
filter(year %in% c(2004, 2009, 2014, 2019), !is.na(develop)) %>%
bar_chart(x = country, y = (foreign_debt_perc), facet = year, top_n = 15, fill = develop) +
labs( x = "", y = "Foreign investors (%)",
title = "Top 15 Countries with Debt Held by Foreign Investors", fill = "Develop") +
theme_classic() +
theme(legend.title = element_text(face = "bold", size = 10)) +
scale_fill_manual("Develop", values = c("EM" = "red4", "AM" = "navyblue"))
