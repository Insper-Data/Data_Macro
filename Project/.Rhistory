geom_line()+
geom_point()+
labs(x = "Year", y = "Foreign Investors (%)", title = "Total Debt Held by Foreign Investors", subtitle = "Emerging Markets - Asia e Africa") +
ylim(0,90)+
theme_bw()
graph_debt_foreign_lamerica <- dataset_total %>%
filter(!is.na(develop)) %>%
rename(Countries = country) %>%
filter(develop=="EM", continent%in% c("South America", "North America")) %>%
mutate(foreign_debt_perc=(foreign_debt/total_debt)*100) %>%
ggplot(aes(x = year, y = foreign_debt_perc, color=Countries)) +
geom_line()+
geom_point()+
labs(x = "Year", y = "Foreign Investors (%)", title = "Total Debt Held by Foreign Investors", subtitle = "Emerging Markets - Latin America") +
ylim(0,90)+
theme_bw()
graph_debt_foreign_europe <- dataset_total %>%
filter(!is.na(develop)) %>%
rename(Countries = country) %>%
filter(develop=="EM", continent=="Europe") %>%
mutate(foreign_debt_perc=(foreign_debt/total_debt)*100) %>%
ggplot(aes(x = year, y = foreign_debt_perc, color=Countries)) +
geom_line()+
geom_point()+
labs(x = "Year", y = "Foreign Investors (%)", title = "Total Debt Held by Foreign Investors", subtitle = "Emerging Markets - Europe") +
ylim(0,90)+
theme_bw()
graph_debt_foreign_lamerica
graph_debt_foreign_europe
graph_debt_foreign_asia
View(dataset_total)
ft1 <- for_ex_BC ~ debt_to_GDP + post_08 + ln_GDP_per_cap_cte + nominal_rate + fx_volatility + account_balance + vix_EUA
reg3.1.1 <- plm(ft1, data = panel_dataset_EM, model = "within", effect = "individual")
reg3.1.2 <- plm(ft1, data = panel_dataset_EM, model = "within", effect = "time")
reg3.1.3 <- plm(ft1, data = panel_dataset_EM, model = "within", effect = "twoways")
reg3.1.4 <- plm(ft1, data = panel_dataset_EM, model = "pooling")
# Clustering errors:
reg3.1.1c <- coeftest(reg3.1.1, vcovHC.plm(reg3.1.1, type="sss", cluster = "group", method = "white2"))[,2]
reg3.1.2c <- coeftest(reg3.1.2, vcovHC.plm(reg3.1.2, type="sss", cluster="group", method = "white2"))[,2]
reg3.1.3c <- coeftest(reg3.1.3, vcovHC.plm(reg3.1.3, type="sss", cluster="group", method = "white2"))[,2]
reg3.1.4c <- coeftest(reg3.1.4, vcovHC.plm(reg3.1.4, type="sss", cluster="group", method = "white2"))[,2]
# Output:
stargazer(reg3.1.1,
reg3.1.2,
reg3.1.3,
reg3.1.4,
title = "Emerging Markets - Threshold comparison", type = "text",
add.lines = list(c("Country FE", "YES", "NO", "YES", "NO"), c("Year FE", "NO", "YES", "YES", "NO")),
se = list(reg3.1.1c, reg3.1.2c, reg3.1.3c, reg3.1.4c),
omit.stat = "f",
dep.var.labels = c("Foreign participation on public debt"))
library(stargazer)
# Output:
stargazer(reg3.1.1,
reg3.1.2,
reg3.1.3,
reg3.1.4,
title = "(Clusterized errors)", type = "text",
add.lines = list(c("Country FE", "YES", "NO", "YES", "NO"), c("Year FE", "NO", "YES", "YES", "NO")),
se = list(reg3.1.1c, reg3.1.2c, reg3.1.3c, reg3.1.4c),
omit.stat = "f",
dep.var.labels = c("Foreign participation on public debt"))
library(tidyverse)
library(plm)
library(stargazer)
library(lmtest)
panel_dataset <- pdata.frame(dataset_total, index = c("country", "year"))
panel_dataset <- panel_dataset %>%
mutate(for_part = (foreign_debt/total_debt), for_ex_BC = ((nonbank_foreign_debt + bank_foreign_debt)/total_debt), for_nonbank_prop = (nonbank_foreign_debt/total_debt), develop = as.character(develop))
#panel dataset_AM
panel_dataset_AM <- panel_dataset %>%
filter(develop == "AM",
country != "United States")  # Tirei os EUA!!!!
#panel dataset_EM
panel_dataset_EM <- panel_dataset %>%
filter(develop == "EM")
ft1 <- for_ex_BC ~ debt_to_GDP + post_08 + ln_GDP_per_cap_cte + nominal_rate + fx_volatility + lending_borroeing_rate + vix_EUA
reg3.1.1 <- plm(ft1, data = panel_dataset_AM, model = "within", effect = "individual")
reg3.1.2 <- plm(ft1, data = panel_dataset_AM, model = "within", effect = "time")
reg3.1.3 <- plm(ft1, data = panel_dataset_AM, model = "within", effect = "twoways")
reg3.1.4 <- plm(ft1, data = panel_dataset_AM, model = "pooling")
# Clustering errors:
reg3.1.1c <- coeftest(reg3.1.1, vcovHC.plm(reg3.1.1, type="sss", cluster = "group", method = "white2"))[,2]
reg3.1.2c <- coeftest(reg3.1.2, vcovHC.plm(reg3.1.2, type="sss", cluster="group", method = "white2"))[,2]
reg3.1.3c <- coeftest(reg3.1.3, vcovHC.plm(reg3.1.3, type="sss", cluster="group", method = "white2"))[,2]
reg3.1.4c <- coeftest(reg3.1.4, vcovHC.plm(reg3.1.4, type="sss", cluster="group", method = "white2"))[,2]
# Output:
stargazer(reg3.1.1,
reg3.1.2,
reg3.1.3,
reg3.1.4,
title = "Advanced Markets", type = "text",
add.lines = list(c("Country FE", "YES", "NO", "YES", "NO"), c("Year FE", "NO", "YES", "YES", "NO")),
se = list(reg3.1.1c, reg3.1.2c, reg3.1.3c, reg3.1.4c),
omit.stat = "f",
dep.var.labels = c("Foreign participation on public debt"))
ft1 <- for_ex_BC ~ debt_to_GDP + post_08 + ln_GDP_per_cap_cte + nominal_rate + fx_volatility + a + vix_EUA
# Regressoes em painel
reg3.1.1 <- plm(ft1, data = panel_dataset_AM, model = "within", effect = "individual")
reg3.1.2 <- plm(ft1, data = panel_dataset_AM, model = "within", effect = "time")
reg3.1.3 <- plm(ft1, data = panel_dataset_AM, model = "within", effect = "twoways")
reg3.1.4 <- plm(ft1, data = panel_dataset_AM, model = "pooling")
# Clustering errors:
reg3.1.1c <- coeftest(reg3.1.1, vcovHC.plm(reg3.1.1, type="sss", cluster = "group", method = "white2"))[,2]
reg3.1.2c <- coeftest(reg3.1.2, vcovHC.plm(reg3.1.2, type="sss", cluster="group", method = "white2"))[,2]
reg3.1.3c <- coeftest(reg3.1.3, vcovHC.plm(reg3.1.3, type="sss", cluster="group", method = "white2"))[,2]
reg3.1.4c <- coeftest(reg3.1.4, vcovHC.plm(reg3.1.4, type="sss", cluster="group", method = "white2"))[,2]
# Output:
stargazer(reg3.1.1,
reg3.1.2,
reg3.1.3,
reg3.1.4,
title = "Advanced Markets", type = "text",
add.lines = list(c("Country FE", "YES", "NO", "YES", "NO"), c("Year FE", "NO", "YES", "YES", "NO")),
se = list(reg3.1.1c, reg3.1.2c, reg3.1.3c, reg3.1.4c),
omit.stat = "f",
dep.var.labels = c("Foreign participation on public debt"))
ft1 <- for_ex_BC ~ debt_to_GDP + post_08 + ln_GDP_per_cap_cte + nominal_rate + fx_volatility + account_balance + vix_EUA
# Regressoes em painel
reg3.1.1 <- plm(ft1, data = panel_dataset_AM, model = "within", effect = "individual")
reg3.1.2 <- plm(ft1, data = panel_dataset_AM, model = "within", effect = "time")
reg3.1.3 <- plm(ft1, data = panel_dataset_AM, model = "within", effect = "twoways")
reg3.1.4 <- plm(ft1, data = panel_dataset_AM, model = "pooling")
# Clustering errors:
reg3.1.1c <- coeftest(reg3.1.1, vcovHC.plm(reg3.1.1, type="sss", cluster = "group", method = "white2"))[,2]
reg3.1.2c <- coeftest(reg3.1.2, vcovHC.plm(reg3.1.2, type="sss", cluster="group", method = "white2"))[,2]
reg3.1.3c <- coeftest(reg3.1.3, vcovHC.plm(reg3.1.3, type="sss", cluster="group", method = "white2"))[,2]
reg3.1.4c <- coeftest(reg3.1.4, vcovHC.plm(reg3.1.4, type="sss", cluster="group", method = "white2"))[,2]
# Output:
stargazer(reg3.1.1,
reg3.1.2,
reg3.1.3,
reg3.1.4,
title = "Advanced Markets", type = "text",
add.lines = list(c("Country FE", "YES", "NO", "YES", "NO"), c("Year FE", "NO", "YES", "YES", "NO")),
se = list(reg3.1.1c, reg3.1.2c, reg3.1.3c, reg3.1.4c),
omit.stat = "f",
dep.var.labels = c("Foreign participation on public debt"))
ft1 <- for_ex_BC ~ debt_to_GDP + post_08 + ln_GDP_per_cap_cte + nominal_rate  + account_balance + vix_EUA
reg3.1.1 <- plm(ft1, data = panel_dataset_AM, model = "within", effect = "individual")
reg3.1.2 <- plm(ft1, data = panel_dataset_AM, model = "within", effect = "time")
reg3.1.3 <- plm(ft1, data = panel_dataset_AM, model = "within", effect = "twoways")
reg3.1.4 <- plm(ft1, data = panel_dataset_AM, model = "pooling")
# Clustering errors:
reg3.1.1c <- coeftest(reg3.1.1, vcovHC.plm(reg3.1.1, type="sss", cluster = "group", method = "white2"))[,2]
reg3.1.2c <- coeftest(reg3.1.2, vcovHC.plm(reg3.1.2, type="sss", cluster="group", method = "white2"))[,2]
reg3.1.3c <- coeftest(reg3.1.3, vcovHC.plm(reg3.1.3, type="sss", cluster="group", method = "white2"))[,2]
reg3.1.4c <- coeftest(reg3.1.4, vcovHC.plm(reg3.1.4, type="sss", cluster="group", method = "white2"))[,2]
# Output:
stargazer(reg3.1.1,
reg3.1.2,
reg3.1.3,
reg3.1.4,
title = "Advanced Markets", type = "text",
add.lines = list(c("Country FE", "YES", "NO", "YES", "NO"), c("Year FE", "NO", "YES", "YES", "NO")),
se = list(reg3.1.1c, reg3.1.2c, reg3.1.3c, reg3.1.4c),
omit.stat = "f",
dep.var.labels = c("Foreign participation on public debt"))
ft1 <- for_ex_BC ~ debt_to_GDP*post_08 + ln_GDP_per_cap_cte + nominal_rate  + account_balance + vix_EUA
# Regressoes em painel
reg3.1.1 <- plm(ft1, data = panel_dataset_AM, model = "within", effect = "individual")
reg3.1.2 <- plm(ft1, data = panel_dataset_AM, model = "within", effect = "time")
reg3.1.3 <- plm(ft1, data = panel_dataset_AM, model = "within", effect = "twoways")
reg3.1.4 <- plm(ft1, data = panel_dataset_AM, model = "pooling")
# Clustering errors:
reg3.1.1c <- coeftest(reg3.1.1, vcovHC.plm(reg3.1.1, type="sss", cluster = "group", method = "white2"))[,2]
reg3.1.2c <- coeftest(reg3.1.2, vcovHC.plm(reg3.1.2, type="sss", cluster="group", method = "white2"))[,2]
reg3.1.3c <- coeftest(reg3.1.3, vcovHC.plm(reg3.1.3, type="sss", cluster="group", method = "white2"))[,2]
reg3.1.4c <- coeftest(reg3.1.4, vcovHC.plm(reg3.1.4, type="sss", cluster="group", method = "white2"))[,2]
# Output:
stargazer(reg3.1.1,
reg3.1.2,
reg3.1.3,
reg3.1.4,
title = "Advanced Markets", type = "text",
add.lines = list(c("Country FE", "YES", "NO", "YES", "NO"), c("Year FE", "NO", "YES", "YES", "NO")),
se = list(reg3.1.1c, reg3.1.2c, reg3.1.3c, reg3.1.4c),
omit.stat = "f",
dep.var.labels = c("Foreign participation on public debt"))
ft1 <- for_ex_BC ~ debt_to_GDP*post_08 + ln_GDP_per_cap_cte + nominal_rate  + lending_borroeing_rate + vix_EUA
reg3.1.1 <- plm(ft1, data = panel_dataset_AM, model = "within", effect = "individual")
reg3.1.2 <- plm(ft1, data = panel_dataset_AM, model = "within", effect = "time")
reg3.1.3 <- plm(ft1, data = panel_dataset_AM, model = "within", effect = "twoways")
reg3.1.4 <- plm(ft1, data = panel_dataset_AM, model = "pooling")
# Clustering errors:
reg3.1.1c <- coeftest(reg3.1.1, vcovHC.plm(reg3.1.1, type="sss", cluster = "group", method = "white2"))[,2]
reg3.1.2c <- coeftest(reg3.1.2, vcovHC.plm(reg3.1.2, type="sss", cluster="group", method = "white2"))[,2]
reg3.1.3c <- coeftest(reg3.1.3, vcovHC.plm(reg3.1.3, type="sss", cluster="group", method = "white2"))[,2]
reg3.1.4c <- coeftest(reg3.1.4, vcovHC.plm(reg3.1.4, type="sss", cluster="group", method = "white2"))[,2]
# Output:
stargazer(reg3.1.1,
reg3.1.2,
reg3.1.3,
reg3.1.4,
title = "Advanced Markets", type = "text",
add.lines = list(c("Country FE", "YES", "NO", "YES", "NO"), c("Year FE", "NO", "YES", "YES", "NO")),
se = list(reg3.1.1c, reg3.1.2c, reg3.1.3c, reg3.1.4c),
omit.stat = "f",
dep.var.labels = c("Foreign participation on public debt"))
reg3.1.1 <- plm(ft1, data = panel_dataset_AM, model = "within", effect = "individual")
reg3.1.2 <- plm(ft1, data = panel_dataset_AM, model = "within", effect = "time")
reg3.1.3 <- plm(ft1, data = panel_dataset_AM, model = "within", effect = "twoways")
reg3.1.4 <- plm(ft1, data = panel_dataset_AM, model = "pooling")
# Clustering errors:
reg3.1.1c <- coeftest(reg3.1.1, vcovHC.plm(reg3.1.1, type="sss", cluster = "group", method = "white2"))[,2]
reg3.1.2c <- coeftest(reg3.1.2, vcovHC.plm(reg3.1.2, type="sss", cluster="group", method = "white2"))[,2]
reg3.1.3c <- coeftest(reg3.1.3, vcovHC.plm(reg3.1.3, type="sss", cluster="group", method = "white2"))[,2]
reg3.1.4c <- coeftest(reg3.1.4, vcovHC.plm(reg3.1.4, type="sss", cluster="group", method = "white2"))[,2]
# Output:
stargazer(reg3.1.1,
reg3.1.2,
reg3.1.3,
reg3.1.4,
title = "Advanced Markets", type = "text",
add.lines = list(c("Country FE", "YES", "NO", "YES", "NO"), c("Year FE", "NO", "YES", "YES", "NO")),
se = list(reg3.1.1c, reg3.1.2c, reg3.1.3c, reg3.1.4c),
omit.stat = "f",
dep.var.labels = c("Foreign participation on public debt"))
panel_dataset <- pdata.frame(dataset_total, index = c("country", "year"))
panel_dataset <- panel_dataset %>%
mutate(for_part = (foreign_debt/total_debt), for_ex_BC = ((nonbank_foreign_debt + bank_foreign_debt)/total_debt), for_nonbank_prop = (nonbank_foreign_debt/total_debt), develop = as.character(develop))
#panel dataset_AM
panel_dataset_AM <- panel_dataset %>%
filter(develop == "AM",
country != "United States")  # Tirei os EUA!!!!
#panel dataset_EM
panel_dataset_EM <- panel_dataset %>%
filter(develop == "EM")
reg3.1.1 <- plm(ft1, data = panel_dataset_AM, model = "within", effect = "individual")
reg3.1.2 <- plm(ft1, data = panel_dataset_AM, model = "within", effect = "time")
reg3.1.3 <- plm(ft1, data = panel_dataset_AM, model = "within", effect = "twoways")
reg3.1.4 <- plm(ft1, data = panel_dataset_AM, model = "pooling")
# Clustering errors:
reg3.1.1c <- coeftest(reg3.1.1, vcovHC.plm(reg3.1.1, type="sss", cluster = "group", method = "white2"))[,2]
reg3.1.2c <- coeftest(reg3.1.2, vcovHC.plm(reg3.1.2, type="sss", cluster="group", method = "white2"))[,2]
reg3.1.3c <- coeftest(reg3.1.3, vcovHC.plm(reg3.1.3, type="sss", cluster="group", method = "white2"))[,2]
reg3.1.4c <- coeftest(reg3.1.4, vcovHC.plm(reg3.1.4, type="sss", cluster="group", method = "white2"))[,2]
# Output:
stargazer(reg3.1.1,
reg3.1.2,
reg3.1.3,
reg3.1.4,
title = "Advanced Markets", type = "text",
add.lines = list(c("Country FE", "YES", "NO", "YES", "NO"), c("Year FE", "NO", "YES", "YES", "NO")),
se = list(reg3.1.1c, reg3.1.2c, reg3.1.3c, reg3.1.4c),
omit.stat = "f",
dep.var.labels = c("Foreign participation on public debt"))
rm(list = ls())
#adicionando libraries
rm(list=ls())
library(tidyverse)
library(scales)
library(ggthemes)
library(spData)
library(gganimate)
library(readr)
library(readxl)
library(spData)
library(plotly)
library(sf)
library(viridis)
library(ggcharts)
library(ggrepel)
library(cowplot)
library(gapminder)
library(plm)
library(stargazer)
library(lmtest)
# Puxando a dataset_total e a dataset_total_index
dataset_total <- read.csv("dataset_total.csv")
dataset_total_index <- read.csv("dataset_total_index.csv")
dataset_total %>%
filter(year %in% c(2004, 2010, 2014, 2019), !is.na(develop)) %>%
rename(Development = develop) %>%
bar_chart(x = country, y = debt_to_GDP, facet = year, top_n = 10, fill = Development) +
labs( x = "", y = "Debt-to-GDP (%)",
title = "Graph 1: Top 10 Debt-to-GDP Ratio", fill = "Development") +
theme_classic() +
scale_fill_manual("Development", values = c("EM" = "red4", "AM" = "navyblue"))+
theme(legend.title = element_text(face = "bold", size = 10))
dataset_total %>%
mutate(foreign_debt_perc=(foreign_debt/total_debt)*100) %>%
rename(Development = develop) %>%
filter(year %in% c(2004, 2010, 2014, 2019), !is.na(Development)) %>%
bar_chart(x = country, y = (foreign_debt_perc), facet = year, top_n = 10, fill = Development) +
labs( x = "", y = "Foreign Investors (%)",
title = "Graph 2: Top 10 Countries with Debt Held by Foreign Investors", fill = "Development") +
theme_classic() +
theme(legend.title = element_text(face = "bold", size = 10)) +
scale_fill_manual("Development", values = c("EM" = "red4", "AM" = "navyblue"))
table_debt_sep <-dataset_total %>%
filter(!is.na(develop)) %>%
rename(Development = develop) %>%
group_by(year, Development) %>%
summarise(debt_to_GDP_mean = mean(debt_to_GDP))
graph_debt_sep <- table_debt_sep %>%
ggplot(aes(x = year, y = debt_to_GDP_mean, color=Development )) +
scale_color_manual(values = c("EM" = "red4", "AM" = "navyblue"))+
geom_point() +
geom_smooth()+
labs(x = "Year", y = "Debt-to-GDP Ratio (%)", title = "Graph 3: Average Debt-to-GDP Ratio", subtitle = "Advanced and Emerging Markets") +
ylim(35,90)+
theme_light()
graph_debt_sep
graph_nominal_rate_sep <- dataset_total %>%
filter(!is.na(develop)) %>%
filter(!is.na(nominal_rate)) %>%
rename(Development = develop) %>%
group_by(year, Development) %>%
summarise(debt_nominal_mean = mean(nominal_rate)) %>%
ggplot(aes(x = year, y = debt_nominal_mean, color=Development )) +
scale_color_manual(values = c("EM" = "red4", "AM" = "navyblue"))+
geom_point() +
geom_line()+
labs(x = "Year", y = "Nominal Rate (%)", title = " Graph 4: Nominal Rate (%) ", subtitle = "Advanced and Emerging Markets" ) +
theme_bw()
graph_nominal_rate_sep
graph_debt_foreign_pp <- dataset_total %>%
filter(!is.na(develop)) %>%
rename(Development = develop) %>%
mutate(foreign_debt_perc=(foreign_debt/total_debt)*100) %>%
group_by(year, Development) %>%
summarise(debt_foreign_pp_mean = mean(foreign_debt_perc)) %>%
ggplot(aes(x = year, y = debt_foreign_pp_mean, color=Development )) +
scale_color_manual(values = c("EM" = "red4", "AM" = "navyblue"))+
geom_point() +
geom_smooth()+
labs(x = "Year", y = "Foreign Investors (%)", title = "Graph 5: Total Debt Held by Foreign Investors", subtitle = "Advanced and Emerging Markets") +
ylim(30,50)+
theme_light()
graph_debt_foreign_pp
graph_debt_asia <- dataset_total %>%
filter(!is.na(develop)) %>%
rename(Countries = country) %>%
filter(develop=="EM", continent %in% c("Asia", "Africa")) %>%
ggplot(aes(x = year, y = debt_to_GDP, color=Countries)) +
geom_line()+
geom_point()+
labs(x = "Year", y = "Debt-to-GDP (%)", title = "Debt-to-GDP Ratio", subtitle = "Emerging Markets - Asia e Africa") +
ylim(0,160)+
theme_bw()
graph_debt_lamerica <- dataset_total %>%
filter(!is.na(develop)) %>%
rename(Countries = country) %>%
filter(develop=="EM", continent%in% c("South America", "North America")) %>%
ggplot(aes(x = year, y = debt_to_GDP, color=Countries)) +
geom_line()+
geom_point()+
labs(x = "Year", y = "Debt-to-GDP (%)", title = "Debt-to-GDP Ratio", subtitle = "Emerging Markets - Latin America") +
ylim(0,160)+
theme_bw()
graph_debt_europe <- dataset_total %>%
filter(!is.na(develop)) %>%
rename(Countries = country) %>%
filter(develop=="EM", continent=="Europe") %>%
ggplot(aes(x = year, y = debt_to_GDP, color=Countries)) +
geom_line()+
geom_point()+
labs(x = "Year", y = "Debt-to-GDP (%)", title = "Debt-to-GDP Ratio", subtitle = "Emerging Markets - Europe") +
ylim(0,160)+
theme_bw()
graph_debt_lamerica
graph_debt_europe
graph_debt_asia
graph_debt_foreign_asia <- dataset_total %>%
filter(!is.na(develop)) %>%
rename(Countries = country) %>%
filter(develop=="EM", continent %in% c("Asia", "Africa")) %>%
mutate(foreign_debt_perc=(foreign_debt/total_debt)*100) %>%
ggplot(aes(x = year, y = foreign_debt_perc, color=Countries)) +
geom_line()+
geom_point()+
labs(x = "Year", y = "Foreign Investors (%)", title = "Total Debt Held by Foreign Investors", subtitle = "Emerging Markets - Asia e Africa") +
ylim(0,90)+
theme_bw()
graph_debt_foreign_lamerica <- dataset_total %>%
filter(!is.na(develop)) %>%
rename(Countries = country) %>%
filter(develop=="EM", continent%in% c("South America", "North America")) %>%
mutate(foreign_debt_perc=(foreign_debt/total_debt)*100) %>%
ggplot(aes(x = year, y = foreign_debt_perc, color=Countries)) +
geom_line()+
geom_point()+
labs(x = "Year", y = "Foreign Investors (%)", title = "Total Debt Held by Foreign Investors", subtitle = "Emerging Markets - Latin America") +
ylim(0,90)+
theme_bw()
graph_debt_foreign_europe <- dataset_total %>%
filter(!is.na(develop)) %>%
rename(Countries = country) %>%
filter(develop=="EM", continent=="Europe") %>%
mutate(foreign_debt_perc=(foreign_debt/total_debt)*100) %>%
ggplot(aes(x = year, y = foreign_debt_perc, color=Countries)) +
geom_line()+
geom_point()+
labs(x = "Year", y = "Foreign Investors (%)", title = "Total Debt Held by Foreign Investors", subtitle = "Emerging Markets - Europe") +
ylim(0,90)+
theme_bw()
graph_debt_foreign_lamerica
graph_debt_foreign_europe
graph_debt_foreign_asia
mundo <- world %>%
mutate(name_long = str_replace_all(string = name_long, pattern = "Russian Federation", replacement = "Russia"),
name_long = str_replace_all(string = name_long, pattern = "Republic of Korea", replacement = "Korea"))
mundo <- mundo %>%
select(-c('continent':'gdpPercap')) %>%
rename(country = name_long) %>%
full_join(dataset_total, by = "country") %>%
mutate(debt_to_GDP = as.numeric(debt_to_GDP))
mundo %>%
ggplot() +
geom_sf(data = mundo, aes(geometry = geom), fill = "gray1") +
geom_sf(aes(fill = debt_to_GDP)) +
scale_fill_viridis_c(name = "(%)", option = "C", trans = "sqrt", direction = -1) +
ggtitle("Debt to GDP") +
labs(subtitle = "Mean of 2004 to 2019") +
theme_map() +
theme(panel.background = element_rect(fill = "white"),
legend.title = element_text(face = "bold", size = 10),
legend.background = element_rect(fill = NA),
plot.title = element_text(face = "bold", size = 15)) +
coord_sf(ylim = c(-50, 90))
legend.title = element_text(colour="blue", size=10,
face="bold")
graph_debt_foreign_sep <- dataset_total %>%
filter(!is.na(develop)) %>%
rename(Development = develop) %>%
mutate(foreign_debt_USD=(foreign_debt*fx)) %>%
group_by(year, Development) %>%
summarise(debt_foreign_mean = mean(foreign_debt_USD)) %>%
ggplot(aes(x = year, y = debt_foreign_mean, color=Development )) +
scale_color_manual(values = c("EM" = "red4", "AM" = "navyblue"))+
geom_point() +
geom_smooth()+
labs(x = "Year", y = "Foreign Investors (Billion USD)", title = "Total Debt Held by Foreign Investors", subtitle = "Advanced and Emerging Markets") +
ylim(0,650)+
theme_bw()
graph_debt_foreign_sep
graph_debt_domestic_sep <- dataset_total %>%
filter(!is.na(develop)) %>%
rename(Development = develop) %>%
mutate(domestic_debt_USD_prop=(domestic_debt/total_debt)*100) %>%
group_by(year, Development) %>%
summarise(debt_domestic_mean = mean(domestic_debt_USD_prop)) %>%
ggplot(aes(x = year, y = debt_domestic_mean, color=Development )) +
scale_color_manual(values = c("EM" = "red4", "AM" = "navyblue"))+
geom_point() +
geom_smooth()+
labs(x = "Year", y = "Domestic Investors (%)", title = "Total Debt Held by Domestic Investors", subtitle = "Advanced and Emerging Markets" ) +
ylim(50,70)+
theme_bw()
graph_debt_domestic_sep
graph_debt_inflation <-  dataset_total %>%
filter(!is.na(develop)) %>%
rename(Development = develop) %>%
ggplot() +
geom_point(aes(inflation_mean, (foreign_debt/total_debt), colour = Development)) +
xlim(0,17)+
ylim(0,1) +
labs(x = "Annual Inflation Rate (%)", y = "Foreign Investors (%) ", title = "Government Debt Held by Foreign Investors X Inflation", subtitle = "45 Countries (2004 - 2019)" ) +
theme_bw()+
scale_colour_manual("Development", values = c("EM" = "red4", "AM" = "navyblue"))
graph_debt_inflation
graph_debt_interest <-  dataset_total %>%
filter(!is.na(develop)) %>%
rename(Development = develop) %>%
ggplot() +
geom_point(aes(nominal_rate, (foreign_debt/total_debt), colour = Development)) +
xlim(0,20)+
ylim(0,1) +
labs(x = "Nominal Interest Rate (%)", y = "Foreign Investors (%)", title = "Government Debt Held by Foreign Investors X Nominal Interest Rate", subtitle = "45 Countries (2004 - 2019)" ) +
theme_bw()+
scale_colour_manual("Development", values = c("EM" = "red4", "AM" = "navyblue"))
graph_debt_interest
#install.packages("gifski") #if not already installed
library(gifski)
ft1 <- for_ex_BC ~ debt_to_GDP + post_08 + ln_GDP_per_cap_cte + nominal_rate + fx_volatility + account_balance + vix_EUA
# Regressoes em painel
reg3.1.1 <- plm(ft1, data = panel_dataset_EM, model = "within", effect = "individual")
#panel dataset_EM
panel_dataset_EM <- panel_dataset %>%
filter(develop == "EM")
panel_dataset <- pdata.frame(dataset_total, index = c("country", "year"))
panel_dataset <- panel_dataset %>%
mutate(for_part = (foreign_debt/total_debt), for_ex_BC = ((nonbank_foreign_debt + bank_foreign_debt)/total_debt), for_nonbank_prop = (nonbank_foreign_debt/total_debt), develop = as.character(develop))
#panel dataset_AM
panel_dataset_AM <- panel_dataset %>%
filter(develop == "AM",
country != "United States")  # Tirei os EUA!!!!
#panel dataset_EM
panel_dataset_EM <- panel_dataset %>%
filter(develop == "EM")
ft2 <- for_ex_BC ~ debt_to_GDP + post_08 + ln_GDP_per_cap_cte + nominal_rate + fx_volatility + account_balance + vix_EUA
# Regressoes em painel
reg3.1.1 <- plm(ft2, data = panel_dataset_EM, model = "within", effect = "individual")
reg3.1.2 <- plm(ft2, data = panel_dataset_EM, model = "within", effect = "time")
reg3.1.3 <- plm(ft2, data = panel_dataset_EM, model = "within", effect = "twoways")
reg3.1.4 <- plm(ft2, data = panel_dataset_EM, model = "pooling")
# Clustering errors:
reg3.1.1c <- coeftest(reg3.1.1, vcovHC.plm(reg3.1.1, type="sss", cluster = "group", method = "white2"))[,2]
reg3.1.2c <- coeftest(reg3.1.2, vcovHC.plm(reg3.1.2, type="sss", cluster="group", method = "white2"))[,2]
reg3.1.3c <- coeftest(reg3.1.3, vcovHC.plm(reg3.1.3, type="sss", cluster="group", method = "white2"))[,2]
reg3.1.4c <- coeftest(reg3.1.4, vcovHC.plm(reg3.1.4, type="sss", cluster="group", method = "white2"))[,2]
# Output:
stargazer(reg3.1.1,
reg3.1.2,
reg3.1.3,
reg3.1.4,
title = "Emerging Markets - Threshold comparison", type = "text",
add.lines = list(c("Country FE", "YES", "NO", "YES", "NO"), c("Year FE", "NO", "YES", "YES", "NO")),
se = list(reg3.1.1c, reg3.1.2c, reg3.1.3c, reg3.1.4c),
omit.stat = "f",
dep.var.labels = c("Foreign participation on public debt"))
