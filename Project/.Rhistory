ggtitle("Série ln(PIB) - trimestral") +
labs(caption = "Fonte: IBGE") +
theme_clean() +
theme(plot.title = element_text(hjust = 0.5)))
# Visualização:
(graph_lnPIB <- ggplot(data = Series, aes(x = t, y = ln_PIB)) +
geom_line(colour = "blue") +
ggtitle("Série ln(PIB) - trimestral") +
labs(caption = "Fonte: IBGE") +
theme_clean() +
theme(plot.title = element_text(hjust = 0.5),
axis.title.x=element_blank()))
ggplot(data = Series, aes(x = t, y = first_diff)) +
geom_line(colour = "blue") +
ggtitle("Série ln(PIB) trimestral") +
labs(caption = "Fonte: IBGE") +
theme_clean() +
theme(plot.title = element_text(hjust = 0.5),
axis.title.x = element_blank()))
ggplot(data = Series, aes(x = t, y = first_diff)) +
geom_line(colour = "blue") +
ggtitle("Série ln(PIB) trimestral") +
labs(caption = "Fonte: IBGE") +
theme_clean() +
theme(plot.title = element_text(hjust = 0.5),
axis.title.x = element_blank()))
(graph_first_diff <- ggplot(data = Series, aes(x = t, y = first_diff)) +
geom_line(colour = "blue") +
ggtitle("Série ln(PIB) trimestral") +
labs(caption = "Fonte: IBGE") +
theme_clean() +
theme(plot.title = element_text(hjust = 0.5),
axis.title.x = element_blank()))
(graph_first_diff <- ggplot(data = Series, aes(x = t, y = first_diff)) +
geom_line(colour = "blue") +
ggtitle("Série ln(PIB) trimestral") +
labs(caption = "Fonte: IBGE") +
theme_clean() +
theme(plot.title = element_text(hjust = 0.5),
axis.title.x = element_blank()))
(graph_first_diff <- ggplot(data = Series, aes(x = t, y = first_diff)) +
geom_line(colour = "blue") +
ggtitle("Série diff_ln(PIB) trimestral") +
labs(caption = "Fonte: IBGE") +
theme_clean() +
theme(plot.title = element_text(hjust = 0.5),
axis.title.x = element_blank()))
# FAC e FACP:
ggtsdisplay(Series$first_diff, lag.max = 20, main = "Correlograma")
acf(Series$first_diff, lag.max = 20)
acf(Series$first_diff, lag.max = 20)
acf(Series$first_diff, lag.max = 20, type = c("correlation"),  plot = TRUE)
acf(Series$first_diff, lag.max = 20, type = c("correlation"),  plot = TRUE, na.action = na.pass)
pacf(Series$first_diff, lag.max = 20, type = c("correlation"),  plot = TRUE, na.action = na.pass)
pacf(Series$first_diff, lag.max = 20, type = c("correlation"),  plot = TRUE, na.action = na.pass)
pacf(Series$first_diff, lag.max = 20, plot = TRUE, na.action = na.pass)
acf(Series$first_diff, lag.max = 20, plot = TRUE, na.action = na.pass)
# FAC e FACP:
ggtsdisplay(Series$first_diff, lag.max = 20, main = "Correlograma")
acf(Series$first_diff, lag.max = 20, plot = TRUE, na.action = na.pass)
acf(Series$first_diff, lag.max = 20, plot = TRUE, na.action = na.pass)
acf(Series$first_diff, lag.max = 20, type = c("correlation"),  plot = TRUE, na.action = na.pass)
# Calculos:
Series <- PIB %>%
rename(PIB = value, t = ref.date) %>%
select(PIB, t) %>%
mutate(ln_PIB = log(PIB), first_diff = (ln_PIB - lag(ln_PIB))) %>%
select(PIB, ln_PIB, t, first_diff)
# Visualização:
(graph_lnPIB <- ggplot(data = Series, aes(x = t, y = ln_PIB)) +
geom_line(colour = "blue") +
ggtitle("Série ln(PIB) - trimestral") +
labs(caption = "Fonte: IBGE") +
theme_clean() +
theme(plot.title = element_text(hjust = 0.5),
axis.title.x=element_blank()))
(graph_first_diff <- ggplot(data = Series, aes(x = t, y = first_diff)) +
geom_line(colour = "blue") +
ggtitle("Série diff_ln(PIB) trimestral") +
labs(caption = "Fonte: IBGE") +
theme_clean() +
theme(plot.title = element_text(hjust = 0.5),
axis.title.x = element_blank()))
# FAC e FACP:
ggtsdisplay(Series$first_diff, lag.max = 20, main = "Correlograma")
acf(Series$first_diff, lag.max = 20, type = c("correlation"),  plot = TRUE, na.action = na.pass)
# Visualização:
(graph_lnPIB <- ggplot(data = Series, aes(x = t, y = ln_PIB)) +
geom_line(colour = "blue") +
ggtitle("Série ln(PIB) - trimestral") +
labs(caption = "Fonte: IBGE") +
theme_clean() +
theme(plot.title = element_text(hjust = 0.5),
axis.title.x=element_blank()))
(graph_first_diff <- ggplot(data = Series, aes(x = t, y = first_diff)) +
geom_line(colour = "blue") +
ggtitle("Série diff_ln(PIB) trimestral") +
labs(caption = "Fonte: IBGE") +
theme_clean() +
theme(plot.title = element_text(hjust = 0.5),
axis.title.x = element_blank()))
# FAC e FACP:
ggtsdisplay(Series$first_diff, lag.max = 20, main = "Correlograma")
acf(Series$first_diff, lag.max = 20, type = c("correlation"),  plot = TRUE, na.action = na.pass)
pacf(Series$first_diff, lag.max = 20, plot = TRUE, na.action = na.pass)
# Modelo:
series_hat <- Arima(Series$first_diff, order = c(3, 0, 0), include.constant = TRUE)
series_hat
series_hat %>% view
series_hat
(inv_roots <- autoplot(series_hat))
(inv_roots <- autoplot(series_hat))
(inv_roots <- autoplot(series_hat))
ggplotly(inv_roots)
inv_roots <- autoplot(series_hat)
inv_roots
library(gganimate)
devtools::install_github('thomasp85/gganimate')
devtools::install_github('thomasp85/gganimate')
install.packages('gganimate')
library(gganimate)
devtools::install_github('thomasp85/tweenr')
devtools::install_github('thomasp85/transformr')
devtools::install_github('thomasp85/tweenr')
rm(list = ls())
library(tidyverse)
library(scales)
library(ggthemes)
library(spData)
library(gganimate)
library(readr)
library(readxl)
library(plotly)
#puaxando a dataset_total e a dataset_total_index
dataset_total <- read.csv("dataset_total.csv")
dataset_total_index <- read.csv("dataset_total_index.csv")
head(dataset_total, 5)
graph_debt <- dataset_total %>%
group_by(year) %>%
filter(!is.na(develop)) %>%
summarise(debt_to_GDP_mean = mean(debt_to_GDP_)) %>%
ggplot(aes(x = year, y = debt_to_GDP_mean)) +
geom_point() +
geom_smooth(color="black")+
labs(x = "Year", y = "Debt to GDP Ratio (%)", title = "                          Average Debt to GDP Ratio for 45 Countries") +
theme_bw()
graph_debt
graph_debt_sep<-dataset_total %>%
filter(!is.na(develop)) %>%
rename(Type=25) %>%
group_by(year, Type) %>%
summarise(debt_to_GDP_mean = mean(debt_to_GDP_)) %>%
ggplot(aes(x = year, y = debt_to_GDP_mean, color=Type )) +
scale_color_manual(values = c("EM" = "red", "AM" = "blue"))+
geom_point() +
geom_smooth()+
labs(x = "Year", y = "Debt to GDP Ratio (%)", title = "  Average Debt to GDP Ratio for Advanced and Emerging Markets") +
theme_bw()
graph_debt_sep
animated_debt_gdp <- ggplot(
dataset_total,
aes(x = GDP_per_cap_cur_USD , y= debt_to_GDP_ , size = GDP_cur, colour = country)
) +
geom_point(show.legend = FALSE, alpha = 0.7) +
scale_color_viridis_d() +
scale_size(range = c(2, 12)) +
theme_bw() +
scale_x_log10() +
labs(x = "GDP per capita", y = "Debt to GDP Ratio (%)")
gif_debt <- animated_debt_gdp + transition_time(year) +
labs(title = "Year: {frame_time}")
gif_debt
library(spData)
library(sf)
#arrumando o mapa
mapa1 <- world %>%
right_join(food1, by = "name_long") %>%
ggplot() +
geom_sf(data = world, aes(geometry = geom), fill = "lightgrey") +
geom_sf(aes(fill = food_category)) +
ggtitle("Tipo de alimento mais consumido") +
labs(subtitle = "por país") +
theme_map() +
theme(legend.position = "right") +
theme(panel.background = element_rect(fill = "lightblue"))
mundo <- mundo %>%
select(-c('continent':'gdpPercap')) %>%
rename(country = name_long) %>%
full_join(dataset_total, by = "country") %>%
mutate(debt_to_GDP_ = as.numeric(debt_to_GDP_))
#arrumando o mapa
mundo <- world %>%
mutate(name_long = str_replace_all(string = name_long, pattern = "Russian Federation", replacement = "Russia"),
name_long = str_replace_all(string = name_long, pattern = "Republic of Korea", replacement = "Korea"))
mundo <- mundo %>%
select(-c('continent':'gdpPercap')) %>%
rename(country = name_long) %>%
full_join(dataset_total, by = "country") %>%
mutate(debt_to_GDP_ = as.numeric(debt_to_GDP_))
mundo %>%
filter(country != "Antarctica") %>%
ggplot() +
geom_sf(data = mundo, aes(geometry = geom), fill = "grey69", colour = "white") +
geom_sf(aes(fill = debt_to_GDP_)) +
scale_fill_viridis_c(option = "plasma", trans = "sqrt", direction = -1) +
ggtitle("Debt-to-GDP ratio") +
labs(caption = "Arslanalp dataset") +
theme(panel.background = element_rect(fill = "white")) +
transition_states(year,
transition_length = 2,
state_length = 1) +
coord_sf(ylim = c(-50, 90))
mundo %>%
filter(country != "Antarctica") %>%
ggplot() +
geom_sf(data = mundo, aes(geometry = geom), fill = "grey69", colour = "white") +
geom_sf(aes(fill = debt_to_GDP_)) +
scale_fill_viridis_c(option = "plasma", trans = "sqrt", direction = -1) +
ggtitle("Debt-to-GDP ratio") +
labs(caption = "Arslanalp dataset", legend() = "Year: {frame_time}") +
theme(panel.background = element_rect(fill = "white")) +
transition_states(year,
transition_length = 2,
state_length = 1) +
coord_sf(ylim = c(-50, 90))
mundo %>%
filter(country != "Antarctica") %>%
ggplot() +
geom_sf(data = mundo, aes(geometry = geom), fill = "grey69", colour = "white") +
geom_sf(aes(fill = debt_to_GDP_)) +
scale_fill_viridis_c(option = "plasma", trans = "sqrt", direction = -1) +
ggtitle("Debt-to-GDP ratio") +
labs(caption = "Arslanalp dataset", title = "Year: {frame_time}") +
theme(panel.background = element_rect(fill = "white")) +
transition_states(year,
transition_length = 2,
state_length = 1) +
coord_sf(ylim = c(-50, 90))
rm(list = ls())
library(tidyverse)
library(scales)
library(ggthemes)
library(spData)
library(gganimate)
library(readr)
library(readxl)
library(spData)
library(plotly)
library(sf)
#puaxando a dataset_total e a dataset_total_index
dataset_total <- read.csv("dataset_total.csv")
dataset_total_index <- read.csv("dataset_total_index.csv")
head(dataset_total, 5)
graph_debt_foreign_sep<-dataset_total %>%
filter(!is.na(develop)) %>%
rename(Type=25) %>%
group_by(year, Type) %>%
summarise(debt_foreign = mean(foreign_debt_)) %>%
ggplot(aes(x = year, y = debt_to_GDP_mean, color=Type )) +
scale_color_manual(values = c("EM" = "red", "AM" = "blue"))+
geom_point() +
geom_smooth()+
labs(x = "Year", y = "Government Gross Debt held by Foreign Investors (%)", title = " Average Debt Held by Foreign Investors for Advanced and Emerging Markets") +
theme_bw()
graph_debt_foreign_sep
graph_debt_foreign_sep<-dataset_total %>%
filter(!is.na(develop)) %>%
rename(Type=25) %>%
group_by(year, Type) %>%
summarise(debt_foreign = mean(foreign_debt_)) %>%
ggplot(aes(x = year, y = debt_foreign, color=Type )) +
scale_color_manual(values = c("EM" = "red", "AM" = "blue"))+
geom_point() +
geom_smooth()+
labs(x = "Year", y = "Government Gross Debt held by Foreign Investors (%)", title = " Average Debt Held by Foreign Investors for Advanced and Emerging Markets") +
theme_bw()
graph_debt_foreign_sep
graph_debt_foreign_sep<-dataset_total %>%
filter(!is.na(develop)) %>%
rename(Type=25) %>%
mutate(debt_foreign_prop=debt_foreign_/total_debt_) %>%
group_by(year, Type) %>%
summarise(debt_foreign_mean = mean(debt_foreign_prop)) %>%
ggplot(aes(x = year, y = debt_foreign_mean, color=Type )) +
scale_color_manual(values = c("EM" = "red", "AM" = "blue"))+
geom_point() +
geom_smooth()+
labs(x = "Year", y = "Government Gross Debt held by Foreign Investors (%)", title = " Average Debt Held by Foreign Investors for Advanced and Emerging Markets") +
theme_bw()
graph_debt_foreign_sep<-dataset_total %>%
filter(!is.na(develop)) %>%
rename(Type=25) %>%
mutate(debt_foreign_prop=foreign_debt_/total_debt_) %>%
group_by(year, Type) %>%
summarise(debt_foreign_mean = mean(debt_foreign_prop)) %>%
ggplot(aes(x = year, y = debt_foreign_mean, color=Type )) +
scale_color_manual(values = c("EM" = "red", "AM" = "blue"))+
geom_point() +
geom_smooth()+
labs(x = "Year", y = "Government Gross Debt held by Foreign Investors (%)", title = " Average Debt Held by Foreign Investors for Advanced and Emerging Markets") +
theme_bw()
graph_debt_foreign_sep
graph_debt_foreign_sep
graph_debt_foreign_sep<-dataset_total %>%
filter(!is.na(develop)) %>%
rename(Type=25) %>%
group_by(year, Type) %>%
summarise(debt_foreign_mean = mean(foreign_debt_)) %>%
ggplot(aes(x = year, y = debt_foreign_mean, color=Type )) +
scale_color_manual(values = c("EM" = "red", "AM" = "blue"))+
geom_point() +
geom_smooth()+
labs(x = "Year", y = "Government Gross Debt held by Foreign Investors", title = "Total Debt Held by Foreign Investors for Advanced and Emerging Markets") +
theme_bw()
graph_debt_foreign_sep
group_by(year, Type) %>%
summarise(debt_foreign_mean = mean(foreign_debt_USD)) %>%
ggplot(aes(x = year, y = debt_foreign_mean, color=Type )) +
scale_color_manual(values = c("EM" = "red", "AM" = "blue"))+
geom_point() +
geom_smooth()+
labs(x = "Year", y = "Government Gross Debt held by Foreign Investors", title = "Total Debt Held by Foreign Investors for Advanced and Emerging Markets") +
theme_bw()
graph_debt_foreign_sep<-dataset_total %>%
filter(!is.na(develop)) %>%
rename(Type=25) %>%
mutate(foreign_debt_USD=(foreign_debt_*fx_)) %>%
group_by(year, Type) %>%
summarise(debt_foreign_mean = mean(foreign_debt_USD)) %>%
ggplot(aes(x = year, y = debt_foreign_mean, color=Type )) +
scale_color_manual(values = c("EM" = "red", "AM" = "blue"))+
geom_point() +
geom_smooth()+
labs(x = "Year", y = "Government Gross Debt held by Foreign Investors", title = "Total Debt Held by Foreign Investors for Advanced and Emerging Markets") +
theme_bw()
graph_debt_foreign_sep
graph_debt_foreign_sep<-dataset_total %>%
filter(!is.na(develop)) %>%
rename(Type=25) %>%
mutate(foreign_debt_USD=(foreign_debt_*fx_)) %>%
group_by(year, Type) %>%
summarise(debt_foreign_mean = mean(foreign_debt_USD)) %>%
ggplot(aes(x = year, y = debt_foreign_mean, color=Type )) +
scale_color_manual(values = c("EM" = "red", "AM" = "blue"))+
geom_point() +
geom_smooth()+
labs(x = "Year", y = "Government Gross Debt held by Foreign Investors (USD)", title = "Total Debt Held by Foreign Investors for Advanced and Emerging Markets") +
theme_bw()
graph_debt_foreign_sep
graph_debt_foreign_sep<-dataset_total %>%
filter(!is.na(develop)) %>%
rename(Type=25) %>%
mutate(foreign_debt_USD=(foreign_debt_*fx_)) %>%
group_by(year, Type) %>%
summarise(debt_foreign_mean = mean(foreign_debt_USD)) %>%
ggplot(aes(x = year, y = debt_foreign_mean, color=Type )) +
scale_color_manual(values = c("EM" = "red", "AM" = "blue"))+
geom_point() +
geom_smooth()+
labs(x = "Year", y = "Government Gross Debt held by Foreign Investors (Billion USD)", title = "Total Debt Held by Foreign Investors for Advanced and Emerging Markets") +
theme_bw()
graph_debt_foreign_sep
graph_debt_domestic_sep<-dataset_total %>%
filter(!is.na(develop)) %>%
rename(Type=25) %>%
mutate(domestic_debt_USD=(domestic_debt_*fx_)) %>%
group_by(year, Type) %>%
summarise(debt_domestic_mean = mean(domestic_debt_USD)) %>%
ggplot(aes(x = year, y = debt_foreign_mean, color=Type )) +
scale_color_manual(values = c("EM" = "red", "AM" = "blue"))+
geom_point() +
geom_smooth()+
labs(x = "Year", y = "Government Gross Debt held by Domestic Investors (Billion USD)", title = "Total Debt Held by Foreign Investors for Advanced and Emerging Markets") +
theme_bw()
graph_debt_domestic_sep
graph_debt_domestic_sep<-dataset_total %>%
filter(!is.na(develop)) %>%
rename(Type=25) %>%
mutate(domestic_debt_USD=(domestic_debt_*fx_)) %>%
group_by(year, Type) %>%
summarise(debt_domestic_mean = mean(domestic_debt_USD)) %>%
ggplot(aes(x = year, y = debt_domestic_mean, color=Type )) +
scale_color_manual(values = c("EM" = "red", "AM" = "blue"))+
geom_point() +
geom_smooth()+
labs(x = "Year", y = "Government Gross Debt held by Domestic Investors (Billion USD)", title = "Total Debt Held by Foreign Investors for Advanced and Emerging Markets") +
theme_bw()
graph_debt_domestic_sep
graph_debt_domestic_sep<-dataset_total %>%
filter(!is.na(develop)) %>%
rename(Type=25) %>%
mutate(domestic_debt_USD=(domestic_debt_*fx_)) %>%
group_by(year, Type) %>%
summarise(debt_domestic_mean = mean(domestic_debt_USD)) %>%
ggplot(aes(x = year, y = debt_domestic_mean, color=Type )) +
scale_color_manual(values = c("EM" = "red", "AM" = "blue"))+
geom_point() +
geom_smooth()+
labs(x = "Year", y = "Government Debt Held by Domestic Investors (Billion USD)", title = "Total Debt Held by Foreign Investors for Advanced and Emerging Markets") +
theme_bw()
graph_debt_domestic_sep
graph_debt_domestic_sep<-dataset_total %>%
filter(!is.na(develop)) %>%
rename(Type=25) %>%
mutate(domestic_debt_USD_prop=(domestic_debt_*total_debt_)) %>%
group_by(year, Type) %>%
summarise(debt_domestic_mean = mean(domestic_debt_USD_prop)) %>%
ggplot(aes(x = year, y = debt_domestic_mean, color=Type )) +
scale_color_manual(values = c("EM" = "red", "AM" = "blue"))+
geom_point() +
geom_smooth()+
labs(x = "Year", y = "Government Debt Held by Domestic Investors (%)", title = "Total Debt Held by Foreign Investors for Advanced and Emerging Markets") +
theme_bw()
graph_debt_domestic_sep
library(tidyverse)
library(scales)
library(ggthemes)
library(spData)
library(gganimate)
library(readr)
library(readxl)
library(spData)
library(plotly)
library(sf)
#puaxando a dataset_total e a dataset_total_index
dataset_total <- read.csv("dataset_total.csv")
dataset_total_index <- read.csv("dataset_total_index.csv")
head(dataset_total, 5)
graph_debt <- dataset_total %>%
group_by(year) %>%
filter(!is.na(develop)) %>%
summarise(debt_to_GDP_mean = mean(debt_to_GDP_)) %>%
ggplot(aes(x = year, y = debt_to_GDP_mean)) +
geom_point() +
geom_smooth(color="black")+
labs(x = "Year", y = "Debt to GDP Ratio (%)", title = "                          Average Debt to GDP Ratio for 45 Countries") +
theme_bw()
graph_debt
graph_debt_sep<-dataset_total %>%
filter(!is.na(develop)) %>%
rename(Type=25) %>%
group_by(year, Type) %>%
summarise(debt_to_GDP_mean = mean(debt_to_GDP_)) %>%
ggplot(aes(x = year, y = debt_to_GDP_mean, color=Type )) +
scale_color_manual(values = c("EM" = "red", "AM" = "blue"))+
geom_point() +
geom_smooth()+
labs(x = "Year", y = "Debt to GDP Ratio (%)", title = "  Average Debt to GDP Ratio for Advanced and Emerging Markets") +
theme_bw()
graph_debt_sep
animated_debt_gdp <- ggplot(
dataset_total,
aes(x = GDP_per_cap_cur_USD , y= debt_to_GDP_ , size = GDP_cur, colour = country)
) +
geom_point(show.legend = FALSE, alpha = 0.7) +
scale_color_viridis_d() +
scale_size(range = c(2, 12)) +
theme_bw() +
scale_x_log10() +
labs(x = "GDP per capita", y = "Debt to GDP Ratio (%)")
gif_debt <- animated_debt_gdp + transition_time(year) +
labs(title = "Year: {frame_time}")
gif_debt
graph_debt_GDP <- dataset_total %>%
group_by(country) %>%
filter(!is.na(develop)) %>%
summarise(debt_to_GDP_mean = mean(debt_to_GDP_) , GDP_per_cap_mean = mean(GDP_per_cap_cur_USD)) %>%
ggplot(aes(x = GDP_per_cap_mean, y = debt_to_GDP_mean, color=country)) +
scale_color_viridis_d() +
geom_point(show.legend = FALSE) +
labs(x = "GDP per Capita", y = "Debt to GDP Ratio (%)", title = " Average for 45 Countries (2004-2019)") +
theme_bw()
ggplotly(graph_debt_GDP, tooltip = c("country"))
graph_debt_foreign_sep<-dataset_total %>%
filter(!is.na(develop)) %>%
rename(Type=25) %>%
mutate(foreign_debt_USD=(foreign_debt_*fx_)) %>%
group_by(year, Type) %>%
summarise(debt_foreign_mean = mean(foreign_debt_USD)) %>%
ggplot(aes(x = year, y = debt_foreign_mean, color=Type )) +
scale_color_manual(values = c("EM" = "red", "AM" = "blue"))+
geom_point() +
geom_smooth()+
labs(x = "Year", y = "Government Debt Held by Foreign Investors (Billion USD)", title = "Total Debt Held by Foreign Investors for Advanced and Emerging Markets") +
theme_bw()
graph_debt_foreign_sep
graph_debt_domestic_sep<-dataset_total %>%
filter(!is.na(develop)) %>%
rename(Type=25) %>%
mutate(domestic_debt_USD_prop=(domestic_debt_*total_debt_)) %>%
group_by(year, Type) %>%
summarise(debt_domestic_mean = mean(domestic_debt_USD_prop)) %>%
ggplot(aes(x = year, y = debt_domestic_mean, color=Type )) +
scale_color_manual(values = c("EM" = "red", "AM" = "blue"))+
geom_point() +
geom_smooth()+
labs(x = "Year", y = "Government Debt Held by Domestic Investors (%)", title = "Total Debt Held by Foreign Investors for Advanced and Emerging Markets") +
theme_bw()
graph_debt_domestic_sep
graph_debt_domestic_sep<-dataset_total %>%
filter(!is.na(develop)) %>%
rename(Type=25) %>%
mutate(domestic_debt_USD_prop=(domestic_debt_*total_debt_)) %>%
group_by(year, Type) %>%
summarise(debt_domestic_mean = mean(domestic_debt_USD_prop)) %>%
ggplot(aes(x = year, y = debt_domestic_mean, color=Type )) +
scale_color_manual(values = c("EM" = "red", "AM" = "blue"))+
geom_point() +
geom_smooth()+
labs(x = "Year", y = "Government Debt Held by Domestic Investors (%)", title = "Debt Held by Foreign Investors for Advanced and Emerging Markets") +
theme_bw()
graph_debt_domestic_sep
