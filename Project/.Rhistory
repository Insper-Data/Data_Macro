summary(reg1.4)
reg1.5 <- plm(for_ex_BC ~ log(foreign_debt_) + debt_to_GDP_ + GDP_per_cap_cte + nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean, data = panel_dataset )
summary(reg1.5)
reg1.6 <- plm(for_ex_BC ~ log(foreign_debt_) + debt_to_GDP_ + fx_ + nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean, data = panel_dataset )
summary(reg1.6)
reg1.7 <- plm(for_ex_BC ~ log(foreign_debt_) + debt_to_GDP_ + fx_ + GDP_per_cap_cte + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean, data = panel_dataset )
summary(reg1.7)
reg1.8 <- plm(for_ex_BC ~  log(foreign_debt_) + debt_to_GDP_ + fx_ + GDP_per_cap_cte + nominal_rate + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean, data = panel_dataset )
summary(reg1.8)
reg1.9 <- plm(for_ex_BC ~  log(foreign_debt_) + debt_to_GDP_ + fx_ + GDP_per_cap_cte + nominal_rate + continent + vix_EUA + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean, data = panel_dataset )
summary(reg1.9)
reg1.10 <- plm(for_ex_BC ~ log(foreign_debt_) + debt_to_GDP_ + fx_ + GDP_per_cap_cte + nominal_rate + continent + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean, data = panel_dataset )
summary(reg1.10)
reg1.11 <- plm(for_ex_BC ~  log(foreign_debt_) + debt_to_GDP_ + fx_ + GDP_per_cap_cte + nominal_rate + continent + vix_EUA + vix_EUR + develop + account_balance + lending_borrow + unemployment + inflation_mean, data = panel_dataset )
summary(reg1.11)
reg1.12 <- plm(for_ex_BC ~ log(foreign_debt_) + debt_to_GDP_ + fx_ + GDP_per_cap_cte + nominal_rate + continent + vix_EUA + vix_EUR + taxes + account_balance + lending_borrow + unemployment + inflation_mean, data = panel_dataset )
summary(reg1.12)
reg1.13 <- plm(for_ex_BC ~  log(foreign_debt_) + debt_to_GDP_ + fx_ + GDP_per_cap_cte + nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + lending_borrow + unemployment + inflation_mean, data = panel_dataset )
summary(reg1.13)
reg1.14 <- plm(for_ex_BC ~ log(foreign_debt_) + debt_to_GDP_ + fx_ + GDP_per_cap_cte + nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + unemployment + inflation_mean, data = panel_dataset )
summary(reg1.14)
reg1.15 <- plm(for_ex_BC ~ log(foreign_debt_) + debt_to_GDP_ + fx_ + GDP_per_cap_cte + nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + inflation_mean, data = panel_dataset )
summary(reg1.15)
reg1.16 <- plm(for_ex_BC ~ log(foreign_debt_) + debt_to_GDP_ + fx_ + GDP_per_cap_cte + nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment, data = panel_dataset )
summary(reg1.16)
reg1.17 <- plm(for_ex_BC ~ log(foreign_debt_) + debt_to_GDP_ + GDP_per_cap_cte + nominal_rate + continent + taxes + develop + unemployment + inflation_mean, data = panel_dataset )
summary(reg1.17)
reg1.18 <- plm(for_ex_BC ~ log(foreign_debt_) + debt_to_GDP_ + GDP_per_cap_cte + nominal_rate + continent + taxes + develop + unemployment, data = panel_dataset )
summary(reg1.18)
reg1.19 <- plm(for_ex_BC ~ log(foreign_debt_) + debt_to_GDP_ + GDP_per_cap_cte + continent + taxes + develop + unemployment, data = panel_dataset )
summary(reg1.19)
reg1.20 <- plm(for_ex_BC ~  log(foreign_debt_) + debt_to_GDP_*develop + GDP_per_cap_cte + nominal_rate + continent + taxes + develop + unemployment, data = panel_dataset )
summary(reg1.20)
reg1.20 <- plm(for_ex_BC ~  log(foreign_debt_) + debt_to_GDP_*develop + GDP_per_cap_cte + nominal_rate + continent + taxes + develop + unemployment, data = panel_dataset )
summary(reg1.20)
reg2 <- plm(for_nonbank_prop ~  debt_to_GDP_ + log(debt_to_GDP_) + fx_ + GDP_per_cap_cte +  nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean , data=panel_dataset  )
summary(reg2)
reg2.1 <- plm(for_nonbank_prop ~  debt_to_GDP_ + fx_ + GDP_per_cap_cte +  nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean , data=panel_dataset  )
summary(reg2.1)
reg2.2 <- plm(for_nonbank_prop ~  log(debt_to_GDP_) + fx_ + GDP_per_cap_cte +  nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean , data=panel_dataset  )
summary(reg2.2)
reg2.3 <- plm(for_nonbank_prop ~  debt_to_GDP_ + log(debt_to_GDP_) +  GDP_per_cap_cte +  nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean , data=panel_dataset  )
summary(reg2.3)
reg2.4<- plm(for_nonbank_prop ~  debt_to_GDP_ + log(debt_to_GDP_) + fx_ +   nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean , data=panel_dataset  )
summary(reg2.4)
reg2.5 <- plm(for_nonbank_prop ~  debt_to_GDP_ + log(debt_to_GDP_) + fx_ + GDP_per_cap_cte +   continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean , data=panel_dataset  )
summary(reg2.5)
reg2.6 <- plm(for_nonbank_prop ~  debt_to_GDP_ + log(debt_to_GDP_) + fx_ + GDP_per_cap_cte +  nominal_rate +  vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean , data=panel_dataset  )
summary(reg2.6)
reg2.7 <- plm(for_nonbank_prop ~  debt_to_GDP_ + log(debt_to_GDP_) + fx_ + GDP_per_cap_cte +  nominal_rate + continent + vix_EUA  + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean , data=panel_dataset  )
summary(reg2.7)
reg2.8 <- plm(for_nonbank_prop ~  debt_to_GDP_ + log(debt_to_GDP_) + fx_ + GDP_per_cap_cte +  nominal_rate + continent +  vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean , data=panel_dataset  )
summary(reg2.8)
reg2.9 <- plm(for_nonbank_prop ~  debt_to_GDP_ + log(debt_to_GDP_) + fx_ + GDP_per_cap_cte +  nominal_rate + continent + vix_EUA + vix_EUR  + develop + account_balance + lending_borrow + unemployment + inflation_mean , data=panel_dataset  )
summary(reg2.9)
reg2.10 <- plm(for_nonbank_prop ~  debt_to_GDP_ + log(debt_to_GDP_) + fx_ + GDP_per_cap_cte +  nominal_rate + continent + vix_EUA + vix_EUR + taxes  + account_balance + lending_borrow + unemployment + inflation_mean , data=panel_dataset  )
summary(reg2.10)
reg2.11 <- plm(for_nonbank_prop ~  debt_to_GDP_ + log(debt_to_GDP_) + fx_ + GDP_per_cap_cte +  nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop  + lending_borrow + unemployment + inflation_mean , data=panel_dataset  )
summary(reg2.11)
reg2.12 <- plm(for_nonbank_prop ~  debt_to_GDP_ + log(debt_to_GDP_) + fx_ + GDP_per_cap_cte +  nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance +  unemployment + inflation_mean , data=panel_dataset  )
summary(reg2.12)
reg2.13 <- plm(for_nonbank_prop ~  debt_to_GDP_ + log(debt_to_GDP_) + fx_ + GDP_per_cap_cte +  nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + inflation_mean , data=panel_dataset  )
summary(reg2.13)
reg2.14 <- plm(for_nonbank_prop ~  debt_to_GDP_ + log(debt_to_GDP_) + fx_ + GDP_per_cap_cte +  nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment , data=panel_dataset  )
summary(reg2.14)
installed.packages("tinytex")
reg3 <- plm(log(for_ex_BC) ~  debt_to_GDP_ + log(debt_to_GDP_) + fx_ + GDP_per_cap_cte +  nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean , data=panel_dataset  )
summary(reg3)
reg1 <- plm(for_ex_BC ~  debt_to_GDP_ + log(debt_to_GDP_) + log(debt_to_GDP_) + fx_ + GDP_per_cap_cte + inflation_mean +  nominal_rate + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment, data=panel_dataset )
summary(reg1)
reg1 <- plm(for_ex_BC ~  debt_to_GDP_ +  log(debt_to_GDP_) + fx_ + GDP_per_cap_cte + inflation_mean +  nominal_rate + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment, data=panel_dataset )
summary(reg1)
reg1 <- plm(for_ex_BC ~  debt_to_GDP_ +  log(debt_to_GDP_) + fx_ + GDP_per_cap_cte + inflation_mean +  nominal_rate + vix_EUA + vix_EUR + taxes + factor(develop) + account_balance + lending_borrow + unemployment, data=panel_dataset )
summary(reg1)
#adicionando libraries
rm(list=ls())
library(tidyverse)
library(scales)
library(ggthemes)
library(spData)
library(gganimate)
library(readr)
library(readxl)
library(spData)
library(plotly)
library(sf)
library(viridis)
library(ggcharts)
library(ggrepel)
library(cowplot)
library(gapminder)
library(plm)
#puaxando a dataset_total e a dataset_total_index
dataset_total <- read.csv("dataset_total.csv")
dataset_total_index <- read.csv("dataset_total_index.csv")
dataset_total %>%
filter(year %in% c(2004, 2009, 2014, 2019), !is.na(develop)) %>%
bar_chart(x = country, y = debt_to_GDP_, facet = year, top_n = 15, fill = develop) +
labs( x = "", y = "Debt to GDP (%)",
title = "Top 15 debt to GDP", fill = "Develop") +
theme_classic() +
scale_fill_manual("Develop", values = c("EM" = "red4", "AM" = "navyblue"))+
theme(legend.title = element_text(face = "bold", size = 10))
dataset_total %>%
mutate(f_debt = foreign_debt_*fx_) %>%
filter(year %in% c(2004, 2009, 2014, 2019), !is.na(develop)) %>%
bar_chart(x = country, y = (f_debt), facet = year, top_n = 15, fill = develop) +
labs( x = "", y = "Debt held by foreign investors (billions USD)",
title = "Top 15 countries with debt held by foreign investors", fill = "Develop") +
theme_classic() +
theme(legend.title = element_text(face = "bold", size = 10)) +
scale_fill_manual("Develop", values = c("EM" = "red4", "AM" = "navyblue"))
mundo <- world %>%
mutate(name_long = str_replace_all(string = name_long, pattern = "Russian Federation", replacement = "Russia"),
name_long = str_replace_all(string = name_long, pattern = "Republic of Korea", replacement = "Korea"))
mundo <- mundo %>%
select(-c('continent':'gdpPercap')) %>%
rename(country = name_long) %>%
full_join(dataset_total, by = "country") %>%
mutate(debt_to_GDP_ = as.numeric(debt_to_GDP_))
mundo %>%
ggplot() +
geom_sf(data = mundo, aes(geometry = geom), fill = "lightgrey") +
geom_sf(aes(fill = debt_to_GDP_)) +
scale_fill_viridis_c(name = "(%)", option = "magma", trans = "sqrt", direction = -1) +
ggtitle("Debt to GDP") +
labs(subtitle = "Mean 2004-2019") +
theme_map() +
theme(panel.background = element_rect(fill = "white"),
legend.title = element_text(face = "bold", size = 10),
legend.background = element_rect(fill = NA),
plot.title = element_text(face = "bold", size = 17)) +
#transition_states(year,
#transition_length = 2,
#state_length = 1) +
coord_sf(ylim = c(-50, 90))
legend.title = element_text(colour="blue", size=10,
face="bold")
graph_debt <- dataset_total %>%
group_by(year) %>%
filter(!is.na(develop)) %>%
summarise(debt_to_GDP_mean = mean(debt_to_GDP_)) %>%
ggplot(aes(x = year, y = debt_to_GDP_mean)) +
geom_point() +
geom_smooth(color="black")+
labs(x = "Year", y = "Debt to GDP ratio (%)", title = "Average debt to GDP ratio for 45 countries") +
theme_light()
graph_debt
graph_debt_sep<-dataset_total %>%
filter(!is.na(develop)) %>%
rename(Type=25) %>%
group_by(year, Type) %>%
summarise(debt_to_GDP_mean = mean(debt_to_GDP_)) %>%
ggplot(aes(x = year, y = debt_to_GDP_mean, color=Type )) +
scale_color_manual(values = c("EM" = "red4", "AM" = "navyblue"))+
geom_point() +
geom_smooth()+
labs(x = "Year", y = "Debt to GDP ratio (%)", title = "Average debt to GDP ratio for advanced and emerging markets") +
theme_light()
graph_debt_sep
graph_debt_GDP <- dataset_total %>%
group_by(country) %>%
filter(!is.na(develop)) %>%
summarise(debt_to_GDP_mean = mean(debt_to_GDP_) , GDP_per_cap_mean = mean(GDP_per_cap_cur_USD)) %>%
ggplot(aes(x = GDP_per_cap_mean, y = debt_to_GDP_mean, color=country)) +
scale_color_viridis_d() +
geom_point(show.legend = FALSE) +
labs(x = "GDP per capita (USD)", y = "Debt to GDP ratio (%)", title = " Average for 45 countries (2004-2019)") +
theme_bw()
graph_debt_GDP
graph_debt_foreign_sep<-dataset_total %>%
filter(!is.na(develop)) %>%
rename(Type=25) %>%
mutate(foreign_debt_USD=(foreign_debt_*fx_)) %>%
group_by(year, Type) %>%
summarise(debt_foreign_mean = mean(foreign_debt_USD)) %>%
ggplot(aes(x = year, y = debt_foreign_mean, color=Type )) +
scale_color_manual(values = c("EM" = "red4", "AM" = "navyblue"))+
geom_point() +
geom_smooth()+
labs(x = "Year", y = "Government debt held by foreign investors (billion USD)", title = "Total debt held by foreign investors for advanced and emerging markets") +
theme_bw()
graph_debt_foreign_sep
graph_debt_domestic_sep<-dataset_total %>%
filter(!is.na(develop)) %>%
rename(Type=25) %>%
mutate(domestic_debt_USD_prop=(domestic_debt_/total_debt_)) %>%
group_by(year, Type) %>%
summarise(debt_domestic_mean = mean(domestic_debt_USD_prop)) %>%
ggplot(aes(x = year, y = debt_domestic_mean, color=Type )) +
scale_color_manual(values = c("EM" = "red4", "AM" = "navyblue"))+
geom_point() +
geom_smooth()+
labs(x = "Year", y = "Government debt held by domestic investors (%)", title = "Debt held by domestic investors for advanced and emerging markets") +
theme_bw()
graph_debt_domestic_sep
graph_debt_inflation <-  dataset_total %>%
filter(!is.na(develop)) %>%
ggplot() +
geom_point(aes(inflation_mean, (total_debt_*fx_), colour = develop)) +
xlim(0,40)+
ylim(0,400) +
labs(x = "Annual inflation rate (%)", y = "Total debt (billion USD)", title = "Total debt X Inflation", subtitle = "45 countries (2004-2019)" ) +
theme_bw()+
scale_colour_manual("Develop", values = c("EM" = "red4", "AM" = "navyblue"))
graph_debt_inflation
panel_dataset <- plm.data(dataset_total, index=c("country", "year"))
panel_dataset <- panel_dataset %>%
mutate(for_part = (foreign_debt_/total_debt_))
panel_dataset <- panel_dataset %>%
mutate(for_ex_BC = ((nonbank_foreign_debt_ + bank_foreign_debt_)/total_debt_))
panel_dataset <- panel_dataset %>%
mutate(for_nonbank_prop = (nonbank_foreign_debt_/total_debt_))
panel_dataset <- panel_dataset %>%
mutate(develop = as.character(develop))
panel_dataset <- panel_dataset %>%
rename(lending_borrow=23)
reg1 <- plm(for_ex_BC ~  debt_to_GDP_ +  log(debt_to_GDP_) + fx_ + GDP_per_cap_cte + inflation_mean +  nominal_rate + vix_EUA + vix_EUR + taxes + factor(develop) + account_balance + lending_borrow + unemployment, data=panel_dataset )
summary(reg1)
reg1.1 <- plm(for_ex_BC ~  log(foreign_debt_) + debt_to_GDP_ + fx_ + GDP_per_cap_cte + nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean, data = panel_dataset )
summary(reg1.1)
reg1.2 <- plm(for_ex_BC ~ log(foreign_debt_) + debt_to_GDP_ + fx_ + GDP_per_cap_cte + nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean, data = panel_dataset )
summary(reg1.2)
reg1.3 <- plm(for_ex_BC ~ debt_to_GDP_ + fx_ + GDP_per_cap_cte + nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean, data = panel_dataset )
summary(reg1.3)
reg1.4 <- plm(for_ex_BC ~ debt_to_GDP_ + fx_ + GDP_per_cap_cte + nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean, data = panel_dataset )
summary(reg1.4)
reg1.5 <- plm(for_ex_BC ~ log(foreign_debt_) + debt_to_GDP_ + GDP_per_cap_cte + nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean, data = panel_dataset )
summary(reg1.5)
reg1.6 <- plm(for_ex_BC ~ log(foreign_debt_) + debt_to_GDP_ + fx_ + nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean, data = panel_dataset )
summary(reg1.6)
reg1.7 <- plm(for_ex_BC ~ log(foreign_debt_) + debt_to_GDP_ + fx_ + GDP_per_cap_cte + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean, data = panel_dataset )
summary(reg1.7)
reg1.8 <- plm(for_ex_BC ~  log(foreign_debt_) + debt_to_GDP_ + fx_ + GDP_per_cap_cte + nominal_rate + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean, data = panel_dataset )
summary(reg1.8)
reg1.9 <- plm(for_ex_BC ~  log(foreign_debt_) + debt_to_GDP_ + fx_ + GDP_per_cap_cte + nominal_rate + continent + vix_EUA + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean, data = panel_dataset )
summary(reg1.9)
reg1.10 <- plm(for_ex_BC ~ log(foreign_debt_) + debt_to_GDP_ + fx_ + GDP_per_cap_cte + nominal_rate + continent + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean, data = panel_dataset )
summary(reg1.10)
reg1.11 <- plm(for_ex_BC ~  log(foreign_debt_) + debt_to_GDP_ + fx_ + GDP_per_cap_cte + nominal_rate + continent + vix_EUA + vix_EUR + develop + account_balance + lending_borrow + unemployment + inflation_mean, data = panel_dataset )
summary(reg1.11)
reg1.12 <- plm(for_ex_BC ~ log(foreign_debt_) + debt_to_GDP_ + fx_ + GDP_per_cap_cte + nominal_rate + continent + vix_EUA + vix_EUR + taxes + account_balance + lending_borrow + unemployment + inflation_mean, data = panel_dataset )
summary(reg1.12)
reg1.13 <- plm(for_ex_BC ~  log(foreign_debt_) + debt_to_GDP_ + fx_ + GDP_per_cap_cte + nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + lending_borrow + unemployment + inflation_mean, data = panel_dataset )
summary(reg1.13)
reg1.14 <- plm(for_ex_BC ~ log(foreign_debt_) + debt_to_GDP_ + fx_ + GDP_per_cap_cte + nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + unemployment + inflation_mean, data = panel_dataset )
summary(reg1.14)
reg1.15 <- plm(for_ex_BC ~ log(foreign_debt_) + debt_to_GDP_ + fx_ + GDP_per_cap_cte + nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + inflation_mean, data = panel_dataset )
summary(reg1.15)
reg1.16 <- plm(for_ex_BC ~ log(foreign_debt_) + debt_to_GDP_ + fx_ + GDP_per_cap_cte + nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment, data = panel_dataset )
summary(reg1.16)
reg1.17 <- plm(for_ex_BC ~ log(foreign_debt_) + debt_to_GDP_ + GDP_per_cap_cte + nominal_rate + continent + taxes + develop + unemployment + inflation_mean, data = panel_dataset )
summary(reg1.17)
reg1.18 <- plm(for_ex_BC ~ log(foreign_debt_) + debt_to_GDP_ + GDP_per_cap_cte + nominal_rate + continent + taxes + develop + unemployment, data = panel_dataset )
summary(reg1.18)
reg1.19 <- plm(for_ex_BC ~ log(foreign_debt_) + debt_to_GDP_ + GDP_per_cap_cte + continent + taxes + develop + unemployment, data = panel_dataset )
summary(reg1.19)
reg1.20 <- plm(for_ex_BC ~  log(foreign_debt_) + debt_to_GDP_*develop + GDP_per_cap_cte + nominal_rate + continent + taxes + develop + unemployment, data = panel_dataset )
summary(reg1.20)
reg1.20 <- plm(for_ex_BC ~  log(foreign_debt_) + debt_to_GDP_*develop + GDP_per_cap_cte + nominal_rate + continent + taxes + develop + unemployment, data = panel_dataset )
summary(reg1.20)
reg2 <- plm(for_nonbank_prop ~  debt_to_GDP_ + log(debt_to_GDP_) + fx_ + GDP_per_cap_cte +  nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean , data=panel_dataset  )
summary(reg2)
reg2.1 <- plm(for_nonbank_prop ~  debt_to_GDP_ + fx_ + GDP_per_cap_cte +  nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean , data=panel_dataset  )
summary(reg2.1)
reg2.2 <- plm(for_nonbank_prop ~  log(debt_to_GDP_) + fx_ + GDP_per_cap_cte +  nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean , data=panel_dataset  )
summary(reg2.2)
reg2.3 <- plm(for_nonbank_prop ~  debt_to_GDP_ + log(debt_to_GDP_) +  GDP_per_cap_cte +  nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean , data=panel_dataset  )
summary(reg2.3)
reg2.4<- plm(for_nonbank_prop ~  debt_to_GDP_ + log(debt_to_GDP_) + fx_ +   nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean , data=panel_dataset  )
summary(reg2.4)
reg2.5 <- plm(for_nonbank_prop ~  debt_to_GDP_ + log(debt_to_GDP_) + fx_ + GDP_per_cap_cte +   continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean , data=panel_dataset  )
summary(reg2.5)
reg2.6 <- plm(for_nonbank_prop ~  debt_to_GDP_ + log(debt_to_GDP_) + fx_ + GDP_per_cap_cte +  nominal_rate +  vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean , data=panel_dataset  )
summary(reg2.6)
reg2.7 <- plm(for_nonbank_prop ~  debt_to_GDP_ + log(debt_to_GDP_) + fx_ + GDP_per_cap_cte +  nominal_rate + continent + vix_EUA  + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean , data=panel_dataset  )
summary(reg2.7)
reg2.8 <- plm(for_nonbank_prop ~  debt_to_GDP_ + log(debt_to_GDP_) + fx_ + GDP_per_cap_cte +  nominal_rate + continent +  vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean , data=panel_dataset  )
summary(reg2.8)
reg2.9 <- plm(for_nonbank_prop ~  debt_to_GDP_ + log(debt_to_GDP_) + fx_ + GDP_per_cap_cte +  nominal_rate + continent + vix_EUA + vix_EUR  + develop + account_balance + lending_borrow + unemployment + inflation_mean , data=panel_dataset  )
summary(reg2.9)
reg2.10 <- plm(for_nonbank_prop ~  debt_to_GDP_ + log(debt_to_GDP_) + fx_ + GDP_per_cap_cte +  nominal_rate + continent + vix_EUA + vix_EUR + taxes  + account_balance + lending_borrow + unemployment + inflation_mean , data=panel_dataset  )
summary(reg2.10)
reg2.11 <- plm(for_nonbank_prop ~  debt_to_GDP_ + log(debt_to_GDP_) + fx_ + GDP_per_cap_cte +  nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop  + lending_borrow + unemployment + inflation_mean , data=panel_dataset  )
summary(reg2.11)
reg2.12 <- plm(for_nonbank_prop ~  debt_to_GDP_ + log(debt_to_GDP_) + fx_ + GDP_per_cap_cte +  nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance +  unemployment + inflation_mean , data=panel_dataset  )
summary(reg2.12)
reg2.13 <- plm(for_nonbank_prop ~  debt_to_GDP_ + log(debt_to_GDP_) + fx_ + GDP_per_cap_cte +  nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + inflation_mean , data=panel_dataset  )
summary(reg2.13)
reg2.14 <- plm(for_nonbank_prop ~  debt_to_GDP_ + log(debt_to_GDP_) + fx_ + GDP_per_cap_cte +  nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment , data=panel_dataset  )
summary(reg2.14)
reg3 <- plm(log(for_ex_BC) ~  debt_to_GDP_ + log(debt_to_GDP_) + fx_ + GDP_per_cap_cte +  nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean , data=panel_dataset  )
summary(reg3)
#adicionando libraries
rm(list=ls())
library(tidyverse)
library(scales)
library(ggthemes)
library(spData)
library(gganimate)
library(readr)
library(readxl)
library(spData)
library(plotly)
library(sf)
library(viridis)
library(ggcharts)
library(ggrepel)
library(cowplot)
library(gapminder)
library(plm)
#puaxando a dataset_total e a dataset_total_index
dataset_total <- read.csv("dataset_total.csv")
dataset_total_index <- read.csv("dataset_total_index.csv")
dataset_total %>%
filter(year %in% c(2004, 2009, 2014, 2019), !is.na(develop)) %>%
bar_chart(x = country, y = debt_to_GDP_, facet = year, top_n = 15, fill = develop) +
labs( x = "", y = "Debt to GDP (%)",
title = "Top 15 debt to GDP", fill = "Develop") +
theme_classic() +
scale_fill_manual("Develop", values = c("EM" = "red4", "AM" = "navyblue"))+
theme(legend.title = element_text(face = "bold", size = 10))
dataset_total %>%
mutate(f_debt = foreign_debt_*fx_) %>%
filter(year %in% c(2004, 2009, 2014, 2019), !is.na(develop)) %>%
bar_chart(x = country, y = (f_debt), facet = year, top_n = 15, fill = develop) +
labs( x = "", y = "Debt held by foreign investors (billions USD)",
title = "Top 15 countries with debt held by foreign investors", fill = "Develop") +
theme_classic() +
theme(legend.title = element_text(face = "bold", size = 10)) +
scale_fill_manual("Develop", values = c("EM" = "red4", "AM" = "navyblue"))
mundo <- world %>%
mutate(name_long = str_replace_all(string = name_long, pattern = "Russian Federation", replacement = "Russia"),
name_long = str_replace_all(string = name_long, pattern = "Republic of Korea", replacement = "Korea"))
mundo <- mundo %>%
select(-c('continent':'gdpPercap')) %>%
rename(country = name_long) %>%
full_join(dataset_total, by = "country") %>%
mutate(debt_to_GDP_ = as.numeric(debt_to_GDP_))
mundo %>%
ggplot() +
geom_sf(data = mundo, aes(geometry = geom), fill = "lightgrey") +
geom_sf(aes(fill = debt_to_GDP_)) +
scale_fill_viridis_c(name = "(%)", option = "magma", trans = "sqrt", direction = -1) +
ggtitle("Debt to GDP") +
labs(subtitle = "Mean 2004-2019") +
theme_map() +
theme(panel.background = element_rect(fill = "white"),
legend.title = element_text(face = "bold", size = 10),
legend.background = element_rect(fill = NA),
plot.title = element_text(face = "bold", size = 17)) +
#transition_states(year,
#transition_length = 2,
#state_length = 1) +
coord_sf(ylim = c(-50, 90))
legend.title = element_text(colour="blue", size=10,
face="bold")
graph_debt <- dataset_total %>%
group_by(year) %>%
filter(!is.na(develop)) %>%
summarise(debt_to_GDP_mean = mean(debt_to_GDP_)) %>%
ggplot(aes(x = year, y = debt_to_GDP_mean)) +
geom_point() +
geom_smooth(color="black")+
labs(x = "Year", y = "Debt to GDP ratio (%)", title = "Average debt to GDP ratio for 45 countries") +
theme_light()
graph_debt
graph_debt_sep<-dataset_total %>%
filter(!is.na(develop)) %>%
rename(Type=25) %>%
group_by(year, Type) %>%
summarise(debt_to_GDP_mean = mean(debt_to_GDP_)) %>%
ggplot(aes(x = year, y = debt_to_GDP_mean, color=Type )) +
scale_color_manual(values = c("EM" = "red4", "AM" = "navyblue"))+
geom_point() +
geom_smooth()+
labs(x = "Year", y = "Debt to GDP ratio (%)", title = "Average debt to GDP ratio for advanced and emerging markets") +
theme_light()
graph_debt_sep
graph_debt_GDP <- dataset_total %>%
group_by(country) %>%
filter(!is.na(develop)) %>%
summarise(debt_to_GDP_mean = mean(debt_to_GDP_) , GDP_per_cap_mean = mean(GDP_per_cap_cur_USD)) %>%
ggplot(aes(x = GDP_per_cap_mean, y = debt_to_GDP_mean, color=country)) +
scale_color_viridis_d() +
geom_point(show.legend = FALSE) +
labs(x = "GDP per capita (USD)", y = "Debt to GDP ratio (%)", title = " Average for 45 countries (2004-2019)") +
theme_bw()
graph_debt_GDP
graph_debt_foreign_sep<-dataset_total %>%
filter(!is.na(develop)) %>%
rename(Type=25) %>%
mutate(foreign_debt_USD=(foreign_debt_*fx_)) %>%
group_by(year, Type) %>%
summarise(debt_foreign_mean = mean(foreign_debt_USD)) %>%
ggplot(aes(x = year, y = debt_foreign_mean, color=Type )) +
scale_color_manual(values = c("EM" = "red4", "AM" = "navyblue"))+
geom_point() +
geom_smooth()+
labs(x = "Year", y = "Government debt held by foreign investors (billion USD)", title = "Total debt held by foreign investors for advanced and emerging markets") +
theme_bw()
graph_debt_foreign_sep
graph_debt_domestic_sep<-dataset_total %>%
filter(!is.na(develop)) %>%
rename(Type=25) %>%
mutate(domestic_debt_USD_prop=(domestic_debt_/total_debt_)) %>%
group_by(year, Type) %>%
summarise(debt_domestic_mean = mean(domestic_debt_USD_prop)) %>%
ggplot(aes(x = year, y = debt_domestic_mean, color=Type )) +
scale_color_manual(values = c("EM" = "red4", "AM" = "navyblue"))+
geom_point() +
geom_smooth()+
labs(x = "Year", y = "Government debt held by domestic investors (%)", title = "Debt held by domestic investors for advanced and emerging markets") +
theme_bw()
graph_debt_domestic_sep
graph_debt_inflation <-  dataset_total %>%
filter(!is.na(develop)) %>%
ggplot() +
geom_point(aes(inflation_mean, (total_debt_*fx_), colour = develop)) +
xlim(0,40)+
ylim(0,400) +
labs(x = "Annual inflation rate (%)", y = "Total debt (billion USD)", title = "Total debt X Inflation", subtitle = "45 countries (2004-2019)" ) +
theme_bw()+
scale_colour_manual("Develop", values = c("EM" = "red4", "AM" = "navyblue"))
graph_debt_inflation
panel_dataset <- plm.data(dataset_total, index=c("country", "year"))
panel_dataset <- panel_dataset %>%
mutate(for_part = (foreign_debt_/total_debt_))
panel_dataset <- panel_dataset %>%
mutate(for_ex_BC = ((nonbank_foreign_debt_ + bank_foreign_debt_)/total_debt_))
panel_dataset <- panel_dataset %>%
mutate(for_nonbank_prop = (nonbank_foreign_debt_/total_debt_))
panel_dataset <- panel_dataset %>%
mutate(develop = as.character(develop))
panel_dataset <- panel_dataset %>%
rename(lending_borrow=23)
reg1 <- plm(for_ex_BC ~  debt_to_GDP_ +  log(debt_to_GDP_) + fx_ + GDP_per_cap_cte + inflation_mean +  nominal_rate + vix_EUA + vix_EUR + taxes + factor(develop) + account_balance + lending_borrow + unemployment, data=panel_dataset )
summary(reg1)
reg1.1 <- plm(for_ex_BC ~  log(foreign_debt_) + debt_to_GDP_ + fx_ + GDP_per_cap_cte + nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean, data = panel_dataset )
summary(reg1.1)
reg1.2 <- plm(for_ex_BC ~ log(foreign_debt_) + debt_to_GDP_ + fx_ + GDP_per_cap_cte + nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean, data = panel_dataset )
summary(reg1.2)
reg1.3 <- plm(for_ex_BC ~ debt_to_GDP_ + fx_ + GDP_per_cap_cte + nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean, data = panel_dataset )
summary(reg1.3)
reg1.4 <- plm(for_ex_BC ~ debt_to_GDP_ + fx_ + GDP_per_cap_cte + nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean, data = panel_dataset )
summary(reg1.4)
reg1.5 <- plm(for_ex_BC ~ log(foreign_debt_) + debt_to_GDP_ + GDP_per_cap_cte + nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean, data = panel_dataset )
summary(reg1.5)
reg1.6 <- plm(for_ex_BC ~ log(foreign_debt_) + debt_to_GDP_ + fx_ + nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean, data = panel_dataset )
summary(reg1.6)
reg1.7 <- plm(for_ex_BC ~ log(foreign_debt_) + debt_to_GDP_ + fx_ + GDP_per_cap_cte + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean, data = panel_dataset )
summary(reg1.7)
reg1.8 <- plm(for_ex_BC ~  log(foreign_debt_) + debt_to_GDP_ + fx_ + GDP_per_cap_cte + nominal_rate + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean, data = panel_dataset )
summary(reg1.8)
reg1.9 <- plm(for_ex_BC ~  log(foreign_debt_) + debt_to_GDP_ + fx_ + GDP_per_cap_cte + nominal_rate + continent + vix_EUA + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean, data = panel_dataset )
summary(reg1.9)
reg1.10 <- plm(for_ex_BC ~ log(foreign_debt_) + debt_to_GDP_ + fx_ + GDP_per_cap_cte + nominal_rate + continent + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean, data = panel_dataset )
summary(reg1.10)
reg1.11 <- plm(for_ex_BC ~  log(foreign_debt_) + debt_to_GDP_ + fx_ + GDP_per_cap_cte + nominal_rate + continent + vix_EUA + vix_EUR + develop + account_balance + lending_borrow + unemployment + inflation_mean, data = panel_dataset )
summary(reg1.11)
reg1.12 <- plm(for_ex_BC ~ log(foreign_debt_) + debt_to_GDP_ + fx_ + GDP_per_cap_cte + nominal_rate + continent + vix_EUA + vix_EUR + taxes + account_balance + lending_borrow + unemployment + inflation_mean, data = panel_dataset )
summary(reg1.12)
reg1.13 <- plm(for_ex_BC ~  log(foreign_debt_) + debt_to_GDP_ + fx_ + GDP_per_cap_cte + nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + lending_borrow + unemployment + inflation_mean, data = panel_dataset )
summary(reg1.13)
reg1.14 <- plm(for_ex_BC ~ log(foreign_debt_) + debt_to_GDP_ + fx_ + GDP_per_cap_cte + nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + unemployment + inflation_mean, data = panel_dataset )
summary(reg1.14)
reg1.15 <- plm(for_ex_BC ~ log(foreign_debt_) + debt_to_GDP_ + fx_ + GDP_per_cap_cte + nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + inflation_mean, data = panel_dataset )
summary(reg1.15)
reg1.16 <- plm(for_ex_BC ~ log(foreign_debt_) + debt_to_GDP_ + fx_ + GDP_per_cap_cte + nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment, data = panel_dataset )
summary(reg1.16)
reg1.17 <- plm(for_ex_BC ~ log(foreign_debt_) + debt_to_GDP_ + GDP_per_cap_cte + nominal_rate + continent + taxes + develop + unemployment + inflation_mean, data = panel_dataset )
summary(reg1.17)
reg1.18 <- plm(for_ex_BC ~ log(foreign_debt_) + debt_to_GDP_ + GDP_per_cap_cte + nominal_rate + continent + taxes + develop + unemployment, data = panel_dataset )
summary(reg1.18)
reg1.19 <- plm(for_ex_BC ~ log(foreign_debt_) + debt_to_GDP_ + GDP_per_cap_cte + continent + taxes + develop + unemployment, data = panel_dataset )
summary(reg1.19)
reg1.20 <- plm(for_ex_BC ~  log(foreign_debt_) + debt_to_GDP_*develop + GDP_per_cap_cte + nominal_rate + continent + taxes + develop + unemployment, data = panel_dataset )
summary(reg1.20)
reg1.20 <- plm(for_ex_BC ~  log(foreign_debt_) + debt_to_GDP_*develop + GDP_per_cap_cte + nominal_rate + continent + taxes + develop + unemployment, data = panel_dataset )
summary(reg1.20)
reg2 <- plm(for_nonbank_prop ~  debt_to_GDP_ + log(debt_to_GDP_) + fx_ + GDP_per_cap_cte +  nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean , data=panel_dataset  )
summary(reg2)
reg2.1 <- plm(for_nonbank_prop ~  debt_to_GDP_ + fx_ + GDP_per_cap_cte +  nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean , data=panel_dataset  )
summary(reg2.1)
reg2.2 <- plm(for_nonbank_prop ~  log(debt_to_GDP_) + fx_ + GDP_per_cap_cte +  nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean , data=panel_dataset  )
summary(reg2.2)
reg2.3 <- plm(for_nonbank_prop ~  debt_to_GDP_ + log(debt_to_GDP_) +  GDP_per_cap_cte +  nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean , data=panel_dataset  )
summary(reg2.3)
reg2.4<- plm(for_nonbank_prop ~  debt_to_GDP_ + log(debt_to_GDP_) + fx_ +   nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean , data=panel_dataset  )
summary(reg2.4)
reg2.5 <- plm(for_nonbank_prop ~  debt_to_GDP_ + log(debt_to_GDP_) + fx_ + GDP_per_cap_cte +   continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean , data=panel_dataset  )
summary(reg2.5)
reg2.6 <- plm(for_nonbank_prop ~  debt_to_GDP_ + log(debt_to_GDP_) + fx_ + GDP_per_cap_cte +  nominal_rate +  vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean , data=panel_dataset  )
summary(reg2.6)
reg2.7 <- plm(for_nonbank_prop ~  debt_to_GDP_ + log(debt_to_GDP_) + fx_ + GDP_per_cap_cte +  nominal_rate + continent + vix_EUA  + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean , data=panel_dataset  )
summary(reg2.7)
reg2.8 <- plm(for_nonbank_prop ~  debt_to_GDP_ + log(debt_to_GDP_) + fx_ + GDP_per_cap_cte +  nominal_rate + continent +  vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean , data=panel_dataset  )
summary(reg2.8)
reg2.9 <- plm(for_nonbank_prop ~  debt_to_GDP_ + log(debt_to_GDP_) + fx_ + GDP_per_cap_cte +  nominal_rate + continent + vix_EUA + vix_EUR  + develop + account_balance + lending_borrow + unemployment + inflation_mean , data=panel_dataset  )
summary(reg2.9)
reg2.10 <- plm(for_nonbank_prop ~  debt_to_GDP_ + log(debt_to_GDP_) + fx_ + GDP_per_cap_cte +  nominal_rate + continent + vix_EUA + vix_EUR + taxes  + account_balance + lending_borrow + unemployment + inflation_mean , data=panel_dataset  )
summary(reg2.10)
reg2.11 <- plm(for_nonbank_prop ~  debt_to_GDP_ + log(debt_to_GDP_) + fx_ + GDP_per_cap_cte +  nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop  + lending_borrow + unemployment + inflation_mean , data=panel_dataset  )
summary(reg2.11)
reg2.12 <- plm(for_nonbank_prop ~  debt_to_GDP_ + log(debt_to_GDP_) + fx_ + GDP_per_cap_cte +  nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance +  unemployment + inflation_mean , data=panel_dataset  )
summary(reg2.12)
reg2.13 <- plm(for_nonbank_prop ~  debt_to_GDP_ + log(debt_to_GDP_) + fx_ + GDP_per_cap_cte +  nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + inflation_mean , data=panel_dataset  )
summary(reg2.13)
reg2.14 <- plm(for_nonbank_prop ~  debt_to_GDP_ + log(debt_to_GDP_) + fx_ + GDP_per_cap_cte +  nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment , data=panel_dataset  )
summary(reg2.14)
reg3 <- plm(log(for_ex_BC) ~  debt_to_GDP_ + log(debt_to_GDP_) + fx_ + GDP_per_cap_cte +  nominal_rate + continent + vix_EUA + vix_EUR + taxes + develop + account_balance + lending_borrow + unemployment + inflation_mean , data=panel_dataset  )
summary(reg3)
