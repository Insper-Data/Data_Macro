anti_join(df1) %>%
anti_join(df2)
# Arranging iso to join in the DMI
iso <- iso_codes %>%
mutate(across(where(is.character), ~ str_remove_all(.x, "(?<=United Kingdom).+")),
across(where(is.character), ~ str_replace_all(.x, "Korea, Republic of", "South Korea")),
across(where(is.character), ~ str_replace_all(.x, "Czechia", "Czech Republic")),
across(where(is.character), ~ str_replace_all(.x, "Kyrgyzstan", "Kyrgyz Republic")),
across(where(is.character), ~ str_remove_all(.x, "(?<=Russia).+")),
across(where(is.character), ~ str_replace_all(.x, "Lao People's Democratic Republic", "Laos")),
across(where(is.character), ~ str_remove_all(.x, "(?<=Syria).+")),
across(where(is.character), ~ str_replace_all(.x, "Congo, Democratic Republic of the", "Democratic Republic of Congo")),
across(where(is.character), ~ str_replace_all(.x, "Bosnia and Herzegovina", "Bosnia and Hercegovina")),
across(where(is.character), ~ str_replace_all(.x, "Côte d'Ivoire", "Côte d’Ivoire")),
across(where(is.character), ~ str_replace_all(.x, "Viet Nam", "Vietnam")),
across(where(is.character), ~ str_replace_all(.x, "Eswatini", "eSwatini")),
across(where(is.character), ~ str_replace_all(.x, "Korea \\(Democratic People's Republic of\\)", "North Korea")),
across(where(is.character), ~ str_remove_all(.x, "(?<=.)\\s\\(.+")),
across(where(is.character), ~ str_remove_all(.x, "(?<=.)\\,\\s.+")),
across(where(is.character), ~ str_replace_all(.x, "(?<!.)Congo(?!,)", "Congo (Brazzaville)")))
# Checking if the changes are correct
democracy %>%
filter(!is.na(location)) %>%
mutate(`Electoral process and pluralism` = as.double(`Electoral process and pluralism`),
Rank = str_remove(Rank, "[=]$")) %>%
anti_join(iso, by = c("location" = "name"))
# Cleaning DMI
dmi <- democracy %>%
filter(!is.na(location)) %>%
mutate(`Electoral process and pluralism` = as.double(`Electoral process and pluralism`),
Rank = str_remove(Rank, "[=]$")) %>%
left_join(iso, by = c("location" = "name")) %>%
mutate(location = str_remove(location, "of America"),
Rank = as.integer(Rank),
type = case_when(
Rank <= 22 ~ "Full democracy",
Rank >= 23 & Rank <= 75 ~ "Flawed democracy",
Rank >= 77 & Rank <= 113 ~ "Hybrid regime",
Rank >= 114 ~ "Authoritarian regime"))
# Cleaning the World Justice Project database (Institutions)
wjptidy <- wjp_2019 %>%
pivot_longer(-Country, names_to = "Countries", values_to = "Countries Codes") %>%
pivot_wider(id_cols = c("Countries", "Countries Codes"),
names_from = "Country", values_from = "Countries Codes") %>%
select(-6) %>%
rename(iso_code = "Country Code", country_name = "Countries") %>%
mutate(across(`WJP Rule of Law Index: Overall Score`:`8.7. Due process of the law and rights of the accused`, ~ as.numeric(.x)))
# Cleaning the Oxford Covid-19 Response Tracker
counter = round(as.numeric(difftime(Sys.Date(), "2020-09-13", units = "days")))
# This line of code generates a counter which make it viable to restore data related to the US and UK
days = (1: (257 + counter))
cpt <- CRT %>%
clean_names() %>%
mutate(date = ymd(date)) %>%
rename(iso_code = "country_code") %>%
select(- c(region_name, region_code)) %>%
relocate(confirmed_cases, .after = country_name) %>%
filter(iso_code != "RKS", jurisdiction == "NAT_TOTAL")
# We opted to desconsider Kosovo, as the country didn't have any information in any of the other databases. Still, we believe that such decision won't change our conclusions in any significant way.
us <- cpt %>%
filter(country_name == "United States") %>%
slice(days)
uk <- cpt %>%
filter(country_name == "United Kingdom") %>%
slice(days)
cpt <- cpt %>%
filter(country_name != "United States" & iso_code != "USA",
country_name != "United Kingdom" & iso_code != "GBR") %>%
bind_rows(us) %>%
bind_rows(uk)
# Cleaning the Gini Index Database
giniOWIDlatest <- giniOWID %>%
group_by(Entity) %>%
filter(Year == max(Year)) %>%
rename(YearGINdata = Year,
"iso_code" = "Code") %>%
clean_names()
animated <- dataset_total %>%
mutate(share = (nonbank_foreign_debt + bank_foreign_debt)/total_debt) %>%
group_by(country, yearnum) %>%
mutate(media_debt_GDP = mean(debt_to_GDP)) %>%
ggplot() +
geom_point(aes(x = debt_to_GDP, y = share), colour = "black") +
geom_text(aes(x = debt_to_GDP, y = share, colour = country, label = country, fontface = 2),
hjust = 0.5, vjust = -0.5, size = 3) +
theme_bw() +
theme(legend.position = "none", plot.title = element_text(size = 15)) +
xlab("Dívida/PIB") +
ylab("% Investidores estrangeiros")
#adicionando libraries
rm(list=ls())
library(tidyverse)
library(scales)
library(ggthemes)
library(spData)
library(gganimate)
library(readr)
library(readxl)
library(spData)
library(plotly)
library(sf)
library(viridis)
library(ggcharts)
library(ggrepel)
library(cowplot)
library(gapminder)
library(plm)
library(stargazer)
library(lmtest)
# Puxando a dataset_total e a dataset_total_index
dataset_total <- read.csv("dataset_total.csv")
dataset_total_index <- read.csv("dataset_total_index.csv")
animated <- dataset_total %>%
mutate(share = (nonbank_foreign_debt + bank_foreign_debt)/total_debt) %>%
group_by(country, yearnum) %>%
mutate(media_debt_GDP = mean(debt_to_GDP)) %>%
ggplot() +
geom_point(aes(x = debt_to_GDP, y = share), colour = "black") +
geom_text(aes(x = debt_to_GDP, y = share, colour = country, label = country, fontface = 2),
hjust = 0.5, vjust = -0.5, size = 3) +
theme_bw() +
theme(legend.position = "none", plot.title = element_text(size = 15)) +
xlab("Dívida/PIB") +
ylab("% Investidores estrangeiros")
(gif_debt <- animated + transition_time(yearnum) +
labs(title = "Year: {frame_time}"))
View(gif_debt)
animated <- dataset_total %>%
mutate(share = (nonbank_foreign_debt + bank_foreign_debt)/total_debt) %>%
group_by(country, yearnum) %>%
mutate(media_debt_GDP = mean(debt_to_GDP)) %>%
ggplot() +
geom_point(aes(x = debt_to_GDP, y = share), colour = "black") +
geom_text(aes(x = debt_to_GDP, y = share, colour = country, label = country, fontface = 2),
hjust = 0.5, vjust = -0.5, size = 3) +
theme_bw() +
theme(legend.position = "none", plot.title = element_text(size = 15)) +
xlab("Dívida/PIB") +
ylab("% Investidores estrangeiros")
(gif_debt <- animated + transition_time(yearnum) +
labs(title = "Year: {frame_time}"))
gganimate(gif_debt, "gif_debt.gif")
animated <- dataset_total %>%
mutate(share = (nonbank_foreign_debt + bank_foreign_debt)/total_debt) %>%
group_by(country, yearnum) %>%
mutate(media_debt_GDP = mean(debt_to_GDP)) %>%
ggplot() +
geom_point(aes(x = debt_to_GDP, y = share), colour = "black") +
geom_text(aes(x = debt_to_GDP, y = share, colour = country, label = country, fontface = 2),
hjust = 0.5, vjust = -0.5, size = 3) +
theme_bw() +
theme(legend.position = "none", plot.title = element_text(size = 15)) +
xlab("Dívida/PIB") +
ylab("% Investidores estrangeiros")
(gif_debt <- animated + transition_time(yearnum) +
labs(title = "Year: {frame_time}"))
magick::image_write(gif_debt, path="myanimation.gif")
install.package("gifski") #if not already installed
install.packages("gifski") #if not already installed
animated <- dataset_total %>%
mutate(share = (nonbank_foreign_debt + bank_foreign_debt)/total_debt) %>%
group_by(country, yearnum) %>%
mutate(media_debt_GDP = mean(debt_to_GDP)) %>%
ggplot() +
geom_point(aes(x = debt_to_GDP, y = share), colour = "black") +
geom_text(aes(x = debt_to_GDP, y = share, colour = country, label = country, fontface = 2),
hjust = 0.5, vjust = -0.5, size = 3) +
theme_bw() +
theme(legend.position = "none", plot.title = element_text(size = 15)) +
xlab("Dívida/PIB") +
ylab("% Investidores estrangeiros")
(gif_debt <- animated + transition_time(yearnum) +
labs(title = "Year: {frame_time}"))
install.packages("gifski") #if not already installed
library(gifski)
animated <- dataset_total %>%
mutate(share = (nonbank_foreign_debt + bank_foreign_debt)/total_debt) %>%
group_by(country, yearnum) %>%
mutate(media_debt_GDP = mean(debt_to_GDP)) %>%
ggplot() +
geom_point(aes(x = debt_to_GDP, y = share), colour = "black") +
geom_text(aes(x = debt_to_GDP, y = share, colour = country, label = country, fontface = 2),
hjust = 0.5, vjust = -0.5, size = 3) +
theme_bw() +
theme(legend.position = "none", plot.title = element_text(size = 15)) +
xlab("Dívida/PIB") +
ylab("% Investidores estrangeiros")
install.packages("gifski")
#install.packages("gifski") #if not already installed
library(gifski)
animated <- dataset_total %>%
mutate(share = (nonbank_foreign_debt + bank_foreign_debt)/total_debt) %>%
group_by(country, yearnum) %>%
mutate(media_debt_GDP = mean(debt_to_GDP)) %>%
ggplot() +
geom_point(aes(x = debt_to_GDP, y = share), colour = "black") +
geom_text(aes(x = debt_to_GDP, y = share, colour = country, label = country, fontface = 2),
hjust = 0.5, vjust = -0.5, size = 3) +
theme_bw() +
theme(legend.position = "none", plot.title = element_text(size = 15)) +
xlab("Dívida/PIB") +
ylab("% Investidores estrangeiros")
#adicionando libraries
rm(list=ls())
library(tidyverse)
library(scales)
library(ggthemes)
library(spData)
library(gganimate)
library(readr)
library(readxl)
library(spData)
library(plotly)
library(sf)
library(viridis)
library(ggcharts)
library(ggrepel)
library(cowplot)
library(gapminder)
library(plm)
library(stargazer)
library(lmtest)
# Puxando a dataset_total e a dataset_total_index
dataset_total <- read.csv("dataset_total.csv")
dataset_total_index <- read.csv("dataset_total_index.csv")
#install.packages("gifski") #if not already installed
library(gifski)
animated <- dataset_total %>%
mutate(share = (nonbank_foreign_debt + bank_foreign_debt)/total_debt) %>%
group_by(country, yearnum) %>%
mutate(media_debt_GDP = mean(debt_to_GDP)) %>%
ggplot() +
geom_point(aes(x = debt_to_GDP, y = share), colour = "black") +
geom_text(aes(x = debt_to_GDP, y = share, colour = country, label = country, fontface = 2),
hjust = 0.5, vjust = -0.5, size = 3) +
theme_bw() +
theme(legend.position = "none", plot.title = element_text(size = 15)) +
xlab("Dívida/PIB") +
ylab("% Investidores estrangeiros")
(gif_debt <- animated + transition_time(yearnum) +
labs(title = "Year: {frame_time}"))
anim_save("filenamehere.gif", gif_debt)
graph_debt_asia <- dataset_total %>%
filter(!is.na(develop)) %>%
rename(Countries = country) %>%
filter(develop=="EM", continent %in% c("Asia", "Africa")) %>%
ggplot(aes(x = year, y = debt_to_GDP, color=Countries)) +
geom_line()+
geom_point()+
labs(x = "Year", y = "Debt-to-GDP (%)", title = "Debt-to-GDP Ratio", subtitle = "Emerging Markets - Asia e Africa") +
ylim(0,160)+
theme_bw()
graph_debt_lamerica <- dataset_total %>%
filter(!is.na(develop)) %>%
rename(Countries = country) %>%
filter(develop=="EM", continent%in% c("South America", "North America")) %>%
ggplot(aes(x = year, y = debt_to_GDP, color=Countries)) +
geom_line()+
geom_point()+
labs(x = "Year", y = "Debt-to-GDP (%)", title = "Debt-to-GDP Ratio", subtitle = "Emerging Markets - Latin America") +
ylim(0,160)+
theme_bw()
graph_debt_europe <- dataset_total %>%
filter(!is.na(develop)) %>%
rename(Countries = country) %>%
filter(develop=="EM", continent=="Europe") %>%
ggplot(aes(x = year, y = debt_to_GDP, color=Countries)) +
geom_line()+
geom_point()+
labs(x = "Year", y = "Debt-to-GDP (%)", title = "Debt-to-GDP Ratio", subtitle = "Emerging Markets - Europe") +
ylim(0,160)+
theme_bw()
graph_debt_lamerica
graph_debt_europe
graph_debt_asia
#adicionando libraries
rm(list=ls())
library(tidyverse)
library(scales)
library(ggthemes)
library(spData)
library(gganimate)
library(readr)
library(readxl)
library(spData)
library(plotly)
library(sf)
library(viridis)
library(ggcharts)
library(ggrepel)
library(cowplot)
library(gapminder)
library(plm)
library(stargazer)
library(lmtest)
# Puxando a dataset_total e a dataset_total_index
dataset_total <- read.csv("dataset_total.csv")
dataset_total_index <- read.csv("dataset_total_index.csv")
library(gifski)
animated_debt_gdp <- dataset_total %>%
filter(!is.na(develop)) %>%
mutate(share = (nonbank_foreign_debt + bank_foreign_debt)/total_debt) %>%
group_by(country, yearnum) %>%
ggplot(aes(x = nominal_rate , y= share, colour = develop, size = nominal_rate)) +
geom_point(show.legend = TRUE, alpha = 0.7) +
scale_size(range = c(2, 12)) +
theme_bw() +
labs(x = "Taxa Real de Juros (%)", y = "Participação estrangeira na dívida pública", title = "Government Debt Held by Foreign Investors X Nominal Interest Rate"
labs(x = "GDP per capita", y = "Debt to GDP Ratio (%)", colour = "Type", size = "GDP per cap (USD)")+
scale_colour_manual("Develop", values = c("EM" = "#0887c0", "AM" = "black"))
(gif_debt <- animated + transition_time(yearnum) +
labs(title = "Year: {frame_time}"))
anim_save("filenamehere.gif", gif_debt)
library(gifski)
animated <- dataset_total %>%
mutate(share = (nonbank_foreign_debt + bank_foreign_debt)/total_debt) %>%
group_by(country, yearnum) %>%
mutate(media_nominal_rate = mean(nominal_rate)) %>%
ggplot() +
geom_point(aes(x = nominal_rate, y = share), colour = "black") +
geom_text(aes(x = nominal_rate, y = share, colour = country, label = country, fontface = 2),
hjust = 0.5, vjust = -0.5, size = 3) +
theme_bw() +
theme(legend.position = "none", plot.title = element_text(size = 15)) +
xlab("Taxa nominal de juros") +
ylab("% Investidores estrangeiros")
(gif_debt <- animated + transition_time(yearnum) +
labs(title = "Year: {frame_time}"))
anim_save("filenamehere.gif", gif_debt)
animated <- dataset_total %>%
mutate(share = (nonbank_foreign_debt + bank_foreign_debt)/total_debt) %>%
group_by(country, yearnum) %>%
filter(country != "Argentina") %>%
ggplot() +
geom_point(aes(x = nominal_rate, y = share), colour = "black") +
geom_text(aes(x = nominal_rate, y = share, colour = country, label = country, fontface = 2),
hjust = 0.5, vjust = -0.5, size = 3) +
theme_bw() +
theme(legend.position = "none", plot.title = element_text(size = 15)) +
xlab("Taxa nominal de juros") +
ylab("% Investidores estrangeiros")
(gif_debt <- animated + transition_time(yearnum) +
labs(title = "Year: {frame_time}"))
anim_save("filenamehere.gif", gif_debt)
mutate(share = (nonbank_foreign_debt + bank_foreign_debt)/total_debt*100 %>%
animated_debt_gdp <- dataset_total %>%
filter(!is.na(develop)) %>%
ggplot(aes(x = GDP_per_cap_cur_USD , y= debt_to_GDP_ , colour = develop, size = GDP_per_cap_cur_USD)) +
geom_point(show.legend = TRUE, alpha = 0.7) +
scale_size(range = c(2, 12)) +
theme_bw() +
scale_x_log10() +
labs(x = "GDP per capita (USD)", y = "Debt to GDP Ratio (%)")+
labs(x = "GDP per capita", y = "Debt to GDP Ratio (%)", colour = "Type", size = "GDP per cap (USD)")+
scale_colour_manual("Develop", values = c("EM" = "red4", "AM" = "navyblue"))
gif_debt <- animated_debt_gdp + transition_time(year) +
filter(country != "Argentina") %>%
animated <- dataset_total %>%
mutate(share = (nonbank_foreign_debt + bank_foreign_debt)/total_debt*100 %>%
group_by(country, yearnum) %>%
filter(country != "Argentina") %>%
ggplot() +
geom_point(aes(x = nominal_rate, y = share), colour = "black") +
geom_text(aes(x = nominal_rate, y = share, colour = country, label = country, fontface = 2),
hjust = 0.5, vjust = -0.5, size = 3) +
theme_bw() +
theme(legend.position = "none", plot.title = element_text(size = 15)) +
xlab("Taxa nominal de juros") +
ylab("% Investidores estrangeiros")
(gif_debt <- animated + transition_time(yearnum) +
labs(title = "Year: {frame_time}"))
anim_save("filenamehere.gif", gif_debt)
#adicionando libraries
rm(list=ls())
library(tidyverse)
library(scales)
library(ggthemes)
library(spData)
library(gganimate)
library(readr)
library(readxl)
library(spData)
library(plotly)
library(sf)
library(viridis)
library(ggcharts)
library(ggrepel)
library(cowplot)
library(gapminder)
library(plm)
library(stargazer)
library(lmtest)
# Puxando a dataset_total e a dataset_total_index
dataset_total <- read.csv("dataset_total.csv")
dataset_total_index <- read.csv("dataset_total_index.csv")
library(gifski)
animated <- dataset_total %>%
mutate(share = (nonbank_foreign_debt + bank_foreign_debt)/total_debt*100 %>%
group_by(country, yearnum) %>%
filter(country != "Argentina") %>%
ggplot() +
geom_point(aes(x = nominal_rate, y = share), colour = "black") +
geom_text(aes(x = nominal_rate, y = share, colour = country, label = country, fontface = 2),
hjust = 0.5, vjust = -0.5, size = 3) +
theme_bw() +
theme(legend.position = "none", plot.title = element_text(size = 15)) +
xlab("Taxa nominal de juros") +
ylab("% Investidores estrangeiros")
(gif_debt <- animated + transition_time(yearnum) +
labs(title = "Year: {frame_time}"))
anim_save("filenamehere.gif", gif_debt)
animated <- dataset_total %>%
mutate(share = (nonbank_foreign_debt + bank_foreign_debt)/total_debt*100 %>%
group_by(country, yearnum) %>%
filter(country != "Argentina") %>%
ggplot() +
geom_point(aes(x = nominal_rate, y = share), colour = "black") +
geom_text(aes(x = nominal_rate, y = share, colour = country, label = country, fontface = 2),
hjust = 0.5, vjust = -0.5, size = 3) +
theme_bw() +
theme(legend.position = "none", plot.title = element_text(size = 15)) +
xlab("Taxa nominal de juros") +
ylab("% Investidores estrangeiros")
(gif_debt <- animated + transition_time(yearnum) +
labs(title = "Year: {frame_time}"))
anim_save("filenamehere.gif", gif_debt)
library(gifski)
animated <- dataset_total %>%
mutate(share = (nonbank_foreign_debt + bank_foreign_debt)/total_debt*100 %>%
group_by(country, yearnum) %>%
filter(country != "Argentina") %>%
ggplot() +
geom_point(aes(x = nominal_rate, y = share), colour = "black") +
geom_text(aes(x = nominal_rate, y = share, colour = country, label = country, fontface = 2),
hjust = 0.5, vjust = -0.5, size = 3) +
theme_bw() +
theme(legend.position = "none", plot.title = element_text(size = 15)) +
xlab("Taxa nominal de juros") +
ylab("% Investidores estrangeiros")
(gif_debt <- animated + transition_time(yearnum) +
labs(title = "Year: {frame_time}"))
anim_save("taxanominal.gif", gif_debt)
(gif_debt <- animated + transition_time(yearnum) +
labs(title = "Year: {frame_time}"))
animated <- dataset_total %>%
mutate(share = ((nonbank_foreign_debt + bank_foreign_debt)/total_debt*100) %>%
group_by(country, yearnum) %>%
filter(country != "Argentina") %>%
ggplot() +
geom_point(aes(x = nominal_rate, y = share), colour = "black") +
geom_text(aes(x = nominal_rate, y = share, colour = country, label = country, fontface = 2),
hjust = 0.5, vjust = -0.5, size = 3) +
theme_bw() +
theme(legend.position = "none", plot.title = element_text(size = 15)) +
xlab("Taxa nominal de juros") +
ylab("% Investidores estrangeiros")
(gif_debt <- animated + transition_time(yearnum) +
labs(title = "Year: {frame_time}"))
anim_save("taxanominal.gif", gif_debt)
library(gifski)
animated <- dataset_total %>%
mutate(share = ((nonbank_foreign_debt + bank_foreign_debt)/total_debt*100) %>%
group_by(country, yearnum) %>%
filter(country != "Argentina") %>%
ggplot() +
geom_point(aes(x = nominal_rate, y = share), colour = "black") +
geom_text(aes(x = nominal_rate, y = share, colour = country, label = country, fontface = 2),
hjust = 0.5, vjust = -0.5, size = 3) +
theme_bw() +
theme(legend.position = "none", plot.title = element_text(size = 15)) +
xlab("Taxa nominal de juros") +
ylab("% Investidores estrangeiros")
(gif_interest <- animated + transition_time(yearnum) +
labs(title = "Year: {frame_time}"))
anim_save("taxanominal.gif", gif_interest)
graph_debt_foreign_asia <- dataset_total %>%
filter(!is.na(develop)) %>%
rename(Countries = country) %>%
filter(develop=="EM", continent %in% c("Asia", "Africa")) %>%
mutate(foreign_debt_perc=(foreign_debt/total_debt)*100) %>%
ggplot(aes(x = year, y = foreign_debt_perc, color=Countries)) +
geom_line()+
geom_point()+
labs(x = "Year", y = "Foreign Investors (%)", title = "Total Debt Held by Foreign Investors", subtitle = "Emerging Markets - Asia e Africa") +
ylim(0,90)+
theme_bw()
graph_debt_foreign_lamerica <- dataset_total %>%
filter(!is.na(develop)) %>%
rename(Countries = country) %>%
filter(develop=="EM", continent%in% c("South America", "North America")) %>%
mutate(foreign_debt_perc=(foreign_debt/total_debt)*100) %>%
ggplot(aes(x = year, y = foreign_debt_perc, color=Countries)) +
geom_line()+
geom_point()+
labs(x = "Year", y = "Foreign Investors (%)", title = "Total Debt Held by Foreign Investors", subtitle = "Emerging Markets - Latin America") +
ylim(0,90)+
theme_bw()
graph_debt_foreign_europe <- dataset_total %>%
filter(!is.na(develop)) %>%
rename(Countries = country) %>%
filter(develop=="EM", continent=="Europe") %>%
mutate(foreign_debt_perc=(foreign_debt/total_debt)*100) %>%
ggplot(aes(x = year, y = foreign_debt_perc, color=Countries)) +
geom_line()+
geom_point()+
labs(x = "Year", y = "Foreign Investors (%)", title = "Total Debt Held by Foreign Investors", subtitle = "Emerging Markets - Europe") +
ylim(0,90)+
theme_bw()
graph_debt_foreign_lamerica
graph_debt_foreign_europe
graph_debt_foreign_asia
View(dataset_total)
